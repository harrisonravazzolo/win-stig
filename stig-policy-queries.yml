---
apiVersion: v1
kind: policy
spec:
  name: STIG - A host-based firewall must be installed and enabled on the system.
  platforms: windows
  platform: windows
  description: A firewall provides a line of defense against attack, allowing or blocking
    inbound and outbound connections based on a set of rules.
  resolution: Install and enable a host-based firewall on the system.
  query: '-- Manual check required: WN11-00-000135

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Bluetooth must be turned off unless approved by the organization.
  platforms: windows
  platform: windows
  description: If not configured properly, Bluetooth may allow rogue devices to communicate
    with a system. If a rogue device is paired with a system, there is potential for
    sensitive information to be compromised.
  resolution: Turn off Bluetooth radios not organizationally approved. Establish an
    organizational policy for the use of Bluetooth.
  query: '-- Manual check required: WN11-00-000210

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Bluetooth must be turned off when not in use.
  platforms: windows
  platform: windows
  description: If not configured properly, Bluetooth may allow rogue devices to communicate
    with a system. If a rogue device is paired with a system, there is potential for
    sensitive information to be compromised.
  resolution: Turn off Bluetooth radios when not in use. Establish an organizational
    policy for the use of Bluetooth to include training of personnel.
  query: '-- Manual check required: WN11-00-000220

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must notify the user when a Bluetooth device attempts to
    connect.
  platforms: windows
  platform: windows
  description: If not configured properly, Bluetooth may allow rogue devices to communicate
    with a system. If a rogue device is paired with a system, there is potential for
    sensitive information to be compromised.
  resolution: Configure Bluetooth to notify users if devices attempt to connect. View
    Bluetooth Settings. Ensure "Alert me when a new Bluetooth device wants to connect"
    is checked.
  query: '-- Manual check required: WN11-00-000230

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Users must be prompted for a password on resume from sleep (on battery).
  platforms: windows
  platform: windows
  description: Authentication must always be required when accessing a system. This
    setting ensures the user is prompted for a password on resume from sleep (on battery).
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Power Management >> Sleep Settings >> "Require a password
    when a computer wakes (on battery)" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51\DCSettingIndex'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The user must be prompted for a password on resume from sleep (plugged
    in).
  platforms: windows
  platform: windows
  description: Authentication must always be required when accessing a system. This
    setting ensures the user is prompted for a password on resume from sleep (plugged
    in).
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Power Management >> Sleep Settings >> "Require a password
    when a computer wakes (plugged in)" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51\ACSettingIndex'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Solicited Remote Assistance must not be allowed.
  platforms: windows
  platform: windows
  description: Remote assistance allows another user to view or take control of the
    local session of a user. Solicited assistance is help that is specifically requested
    by the local user. This may allow unauthorized parties access to the resources
    on the computer.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Remote Assistance >> "Configure Solicited Remote Assistance"
    to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
    NT\Terminal Services\fAllowToGetHelp' AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: SolicitedRemoteAssistance.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Unauthenticated RPC clients must be restricted from connecting to the
    RPC server.
  platforms: windows
  platform: windows
  description: Configuring RPC to restrict unauthenticated RPC clients from connecting
    to the RPC server will prevent anonymous connections.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Remote Procedure Call >> "Restrict Unauthenticated RPC
    clients" to "Enabled" and "Authenticated".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
    NT\Rpc\RestrictRemoteClients' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: RestrictUnauthenticatedRPCClients.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to the required LDAP client signing level.
  platforms: windows
  platform: windows
  description: This setting controls the signing requirements for LDAP clients. This
    setting must be set to Negotiate signing or Require signing, depending on the
    environment and type of LDAP server in use.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    LDAP client signing requirements" to "Negotiate signing" at a minimum.'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LDAP\LDAPClientIntegrity'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The setting to allow Microsoft accounts to be optional for modern style
    apps must be enabled.
  platforms: windows
  platform: windows
  description: Control of credentials and the system must be maintained within the
    enterprise. Enabling this setting allows enterprise credentials to be used with
    modern style apps that support this, instead of Microsoft accounts.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> App Runtime >> "Allow Microsoft accounts to
    be optional" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\MSAOptional'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG
  fix: AllowMicrosoftAccountsToBeOptional.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Domain-joined systems must use Windows 11 Enterprise Edition 64-bit
    version.
  platforms: windows
  platform: windows
  description: Features such as Credential Guard use virtualization-based security
    to protect information that could be used in credential theft attacks if compromised.
    There are a number of system requirements that must be met in order for Credential
    Guard to be configured and enabled properly. Virtualization-based security and
    Credential Guard are only available with Windows 11 Enterprise 64-bit version.
  resolution: Use Windows 11 Enterprise 64-bit version for domain-joined systems.
  query: SELECT 1 FROM os_version WHERE codename LIKE '%Enterprise%' AND arch = '64-bit'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Alternate operating systems must not be permitted on the same system.
  platforms: windows
  platform: windows
  description: Allowing other operating systems to run on a secure system may allow
    security to be circumvented.
  resolution: Ensure Windows 11 is the only operating system on a device. Remove alternate
    operating systems.
  query: '-- Manual check required: WN11-00-000055

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Telnet Client must not be installed on the system.
  platforms: windows
  platform: windows
  description: The "Telnet Client" is not installed by default. Some protocols and
    services do not support required security features, such as encrypting passwords
    or traffic.
  resolution: Uninstall "Telnet Client" from the system.  Run "Programs and Features".
    Select "Turn Windows Features on or off".  De-select "Telnet Client".
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path = 'C:\Windows\System32\telnet.exe')
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisableTelnet.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The TFTP Client must not be installed on the system.
  platforms: windows
  platform: windows
  description: The "TFTP Client" is not installed by default. Some protocols and services
    do not support required security features, such as encrypting passwords or traffic.
  resolution: Uninstall "TFTP Client" from the system.  Run "Programs and Features".
    Select "Turn Windows Features on or off". De-select "TFTP Client".
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path = 'C:\Windows\System32\tftp.exe')
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisableTftp.ps1
---
apiVersion: v1
kind: policy
spec:
  name: STIG - Remote Desktop Services must always prompt a client for passwords upon
    connection.
  platforms: windows
  platform: windows
  description: This setting controls the ability of users to supply passwords automatically
    as part of their remote desktop connection. Disabling this setting would allow
    anyone to use the stored credentials in a connection item to connect to the terminal
    server.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Remote Desktop Services >> Remote Desktop Session
    Host >> Security >> "Always prompt for password upon connection" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
    NT\Terminal Services\fPromptForPassword' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PromptForPasswordUponConnection.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to prevent users from receiving suggestions
    for third-party or additional applications.
  platforms: windows
  platform: windows
  description: Windows spotlight features may suggest apps and content from third-party
    software publishers in addition to Microsoft apps and content.
  resolution: Configure the policy value for User Configuration >> Administrative
    Templates. >> Windows Components >> Cloud Content >> "Do not suggest third-party
    content in Windows spotlight" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\CloudContent\DisableThirdPartySuggestions'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Outgoing secure channel traffic must be encrypted or signed.
  platforms: windows
  platform: windows
  description: Requests sent on the secure channel are authenticated, and sensitive
    information (such as passwords) is encrypted, but not all information is encrypted.
    If this policy is enabled, outgoing secure channel traffic will be encrypted and
    signed.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Domain member:
    Digitally encrypt or sign secure channel data (always)" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\RequireSignOrSeal'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: RequireSignOrSeal.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Outgoing secure channel traffic must be encrypted.
  platforms: windows
  platform: windows
  description: Requests sent on the secure channel are authenticated, and sensitive
    information (such as passwords) is encrypted, but not all information is encrypted.
    If this policy is enabled, outgoing secure channel traffic will be encrypted.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Domain member:
    Digitally encrypt secure channel data (when possible)" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\SealSecureChannel'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: SealSecureChannel.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Outgoing secure channel traffic must be signed.
  platforms: windows
  platform: windows
  description: Requests sent on the secure channel are authenticated, and sensitive
    information (such as passwords) is encrypted, but the channel is not integrity
    checked. If this policy is enabled, outgoing secure channel traffic will be signed.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Domain member:
    Digitally sign secure channel data (when possible)" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\SignSecureChannel'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: SignSecureChannel.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Anonymous enumeration of SAM accounts must not be allowed.
  platforms: windows
  platform: windows
  description: Anonymous enumeration of SAM accounts allows anonymous log on users
    (null session connections) to list all accounts names, thus providing a list of
    potential points to attack the system.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network access:
    Do not allow anonymous enumeration of SAM accounts" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\restrictanonymoussam'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: restrictanonymoussam.ps1
---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 domain-joined systems must have a Trusted Platform Module
    (TPM) enabled.
  platforms: windows
  platform: windows
  description: Credential Guard uses virtualization-based security to protect information
    that could be used in credential theft attacks if compromised. There are a number
    of system requirements that must be met in order for Credential Guard to be configured
    and enabled properly. Without a TPM enabled and ready for use, Credential Guard
    keys are stored in a less secure method using software.
  resolution: For standalone systems, this is NA.  Virtualization-based security,
    including Credential Guard, currently cannot be implemented in virtual desktop
    implementations (VDI) due to specific supporting requirements including a TPM,
    UEFI with Secure Boot, and the capability to run the Hyper-V feature within the
    virtual desktop.  For VDIs where the virtual desktop instance is deleted or refreshed
    upon logoff, this is NA.  Ensure domain-joined systems must have a TPM that is
    configured for use. (Versi...
  query: SELECT 1 FROM tpm_info WHERE activated  = 1 AND enabled = 1;
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: No fix. Alert only.
---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 systems must have Unified Extensible Firmware Interface
    (UEFI) firmware and be configured to run in UEFI mode, not Legacy BIOS.
  platforms: windows
  platform: windows
  description: UEFI provides additional security features in comparison to legacy
    BIOS firmware, including Secure Boot. UEFI is required to support additional security
    features in Windows 11, including virtualization-based Security and Credential
    Guard. Systems with UEFI that are operating in Legacy BIOS mode will not support
    these security features.
  resolution: Configure UEFI firmware to run in UEFI mode, not Legacy BIOS mode.
  query: SELECT 1 FROM platform_info WHERE firmware_type = 'uefi'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: No fix. Alert only?

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Secure Boot must be enabled on Windows 11 systems.
  platforms: windows
  platform: windows
  description: Secure Boot is a standard that ensures systems boot only to a trusted
    operating system. Secure Boot is required to support additional security features
    in Windows 11, including virtualization-based Security and Credential Guard. If
    Secure Boot is turned off, these security features will not function.
  resolution: Enable Secure Boot in the system firmware.
  query: SELECT 1 FROM secureboot WHERE secure_boot = 1;
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: No fix. Alerting only.

---
apiVersion: v1
kind: policy
spec:
  name: 'STIG - Windows 11 must employ automated mechanisms to determine the state
    of system components with regard to flaw remediation using the following frequency:
    Continuously, where ESS is used; 30 days, for any additional internal network
    scans not covered by ESS; and annually, for external scans by Computer Network
    Defense Service Provider (CNDSP).'
  platforms: windows
  platform: windows
  description: An approved tool for continuous network scanning must be installed
    and configured to run.  Without the use of automated mechanisms to scan for security
    flaws on a continuous and/or periodic basis, the operating system or other system
    components may remain vulnerable to the exploits presented by undetected software
    flaws.  To support this requirement, the operating system may have an integrated
    solution incorporating continuous scanning using ESS and periodic scanning using
    other tools, as spe...
  resolution: Install DOD-approved ESS software and ensure it is operating continuously.
  query: '-- Manual check required: WN11-00-000025

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 information systems must use BitLocker to encrypt all disks
    to protect the confidentiality and integrity of all information at rest.
  platforms: windows
  platform: windows
  description: If data at rest is unencrypted, it is vulnerable to disclosure. Even
    if the operating system enforces permissions on data access, an adversary can
    remove non-volatile memory and read it directly, thereby circumventing operating
    system controls. Encrypting the data ensures that confidentiality is protected
    even when the operating system is not running.
  resolution: 'Enable full disk encryption on all information systems (including SIPRNet)
    using BitLocker.  BitLocker, included in Windows, can be enabled in the Control
    Panel under "BitLocker Drive Encryption" as well as other management tools.  Note:
    An alternate encryption application may be used in lieu of BitLocker providing
    it is configured for full disk encryption and satisfies the pre-boot authentication
    requirements (WN11-00-000031 and WN11-00-000032).'
  query: SELECT 1 FROM bitlocker_info WHERE drive_letter='C:' AND protection_status=1;
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: Enable via Fleet MDM.

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The period of time before the bad logon counter is reset must be configured
    to 15 minutes.
  platforms: windows
  platform: windows
  description: The account lockout feature, when enabled, prevents brute-force password
    attacks on the system. This parameter specifies the period of time that must pass
    after failed logon attempts before the counter is reset to 0. The smaller this
    value is, the less effective the account lockout feature will be in protecting
    the local system.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Account Lockout Policy >> "Reset account
    lockout counter after" to "15" minutes.
  query: '-- Manual check required: WN11-AC-000015

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 systems must use a BitLocker PIN for pre-boot authentication.
  platforms: windows
  platform: windows
  description: If data at rest is unencrypted, it is vulnerable to disclosure. Even
    if the operating system enforces permissions on data access, an adversary can
    remove non-volatile memory and read it directly, thereby circumventing operating
    system controls. Encrypting the data ensures that confidentiality is protected
    even when the operating system is not running. Pre-boot authentication prevents
    unauthorized users from accessing encrypted drives.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> BitLocker Drive Encryption >> Operating System
    Drives "Require additional authentication at startup" to "Enabled" with "Configure
    TPM Startup PIN:" set to "Require startup PIN with TPM" or with "Configure TPM
    startup key and PIN:" set to "Require startup key and PIN with TPM".
  query: SELECT 1 FROM bitlocker_key_protectors WHERE drive_letter = 'C:' AND key_protector_type = 4;
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: Enable Bitlocker PIN via Fleet MDM.

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 systems must use a BitLocker PIN with a minimum length of
    six digits for pre-boot authention
  platforms: windows
  platform: windows
  description: If data at rest is unencrypted, it is vulnerable to disclosure. Even
    if the operating system enforces permissions on data access, an adversary can
    remove non-volatile memory and read it directly, thereby circumventing operating
    system controls. Encrypting the data ensures that confidentiality is protected
    even when the operating system is not running. Pre-boot authentication prevents
    unauthorized users from accessing encrypted drives. Increasing the pin length
    requires a greater number of gue...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> BitLocker Drive Encryption >> Operating System
    Drives "Configure minimum PIN length for startup" to "Enabled" with "Minimum characters:"
    set to "6" or greater.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\MinimumPIN'
    AND CAST(data AS INTEGER) >= 6);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: Enable Bitlocker PIN via Fleet MDM.

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The operating system must employ a deny-all, permit-by-exception policy
    to allow the execution of authorized software programs.
  platforms: windows
  platform: windows
  description: Utilizing an allowlist provides a configuration management method for
    allowing the execution of only authorized software. Using only authorized software
    decreases risk by limiting the number of potential vulnerabilities.  The organization
    must identify authorized software programs and only permit execution of authorized
    software. The process used to identify software programs that are authorized to
    execute on organizational information systems is commonly referred to as allowlisting.
  resolution: Configure an application allowlisting program to employ a deny-all,
    permit-by-exception policy to allow the execution of authorized software programs.  Configuration
    of allowlisting applications will vary by the program. AppLocker is an allowlisting
    application built into Windows 11 Enterprise.  If AppLocker is used, it is configured
    through group policy in Computer Configuration >> Windows Settings >> Security
    Settings >> Application Control Policies >> AppLocker.  Implementation guidance
    fo...
  query: '-- Manual check required: WN11-00-000035

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 systems must be maintained at a supported servicing level.
  platforms: windows
  platform: windows
  description: Windows 11 is maintained by Microsoft at servicing levels for specific
    periods of time to support Windows as a Service. Systems at unsupported servicing
    levels or releases will not receive security updates for new vulnerabilities which
    leaves them subject to exploitation.  New versions with feature updates are planned
    to be released on a semi-annual basis with an estimated support timeframe of 18
    to 30 months depending on the release. Support for previously released versions
    has been extended...
  resolution: Update systems on the Semi-Annual Channel to "Microsoft Windows 11 Version
    22H2 (OS Build 22621.380)" or greater.
  query: '-- Manual check required: WN11-00-000040

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows 11 system must use an antivirus program.
  platforms: windows
  platform: windows
  description: Malicious software can establish a base on individual desktops and
    servers. Employing an automated mechanism to detect this type of software will
    aid in elimination of the software from the operating system.
  resolution: Install Microsoft Defender Antivirus or a third-party antivirus solution.
  query: '-- Manual check required: WN11-00-000045

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Local volumes must be formatted using NTFS.
  platforms: windows
  platform: windows
  description: The ability to set access permissions and auditing is critical to maintaining
    the security and proper access controls of a system. To support this, volumes
    must be formatted using the NTFS file system.
  resolution: Format all local volumes to use NTFS.
  query: SELECT 1 from logical_drives WHERE file_system = 'ntfs';
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: No fix, alerting only.

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Non-system-created file shares on a system must limit access to groups
    that require it.
  platforms: windows
  platform: windows
  description: Shares which provide network access, must not exist on a workstation
    except for system-created administrative shares, and could potentially expose
    sensitive information. If a share is necessary, share permissions, as well as
    NTFS permissions, must be reconfigured to give the minimum access to those accounts
    that require it.
  resolution: If a non-system-created share is required on a system, configure the
    share and NTFS permissions to limit access to the specific groups or accounts
    that require it.  Remove any unnecessary non-system-created shares.
  query: '-- Manual check required: WN11-00-000060

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Unused accounts must be disabled or removed from the system after 35
    days of inactivity.
  platforms: windows
  platform: windows
  description: 'Outdated or unused accounts provide penetration points that may go
    undetected. Inactive accounts must be deleted if no longer necessary or, if still
    required, disable until needed.  Satisfies: SRG-OS-000468-GPOS-00212, SRG-OS-000118-GPOS-00060'
  resolution: Review local accounts and verify their necessity. Disable or delete
    any active accounts that have not been used in the last 35 days.
  query: '-- Manual check required: WN11-00-000065

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Only accounts responsible for the administration of a system must have
    Administrator rights on the system.
  platforms: windows
  platform: windows
  description: An account that does not have Administrator duties must not have Administrator
    rights. Such rights would allow the account to bypass or modify required security
    restrictions on that machine and make it vulnerable to attack.  System administrators
    must log on to systems only using accounts with the minimum level of authority
    necessary.  For domain-joined workstations, the Domain Admins group must be replaced
    by a domain workstation administrator group (see V-36434 in the Active Directory
    Domai...
  resolution: Configure the system to include only administrator groups or accounts
    that are responsible for the system in the local Administrators group.  For domain-joined
    workstations, the Domain Admins group must be replaced by a domain workstation
    administrator group.  Remove any standard user accounts.
  query: '-- Manual check required: WN11-00-000070

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Only accounts responsible for the backup operations must be members
    of the Backup Operators group.
  platforms: windows
  platform: windows
  description: Backup Operators are able to read and write to any file in the system,
    regardless of the rights assigned to it. Backup and restore rights permit users
    to circumvent the file access restrictions present on NTFS disk drives for backup
    and restore purposes. Members of the Backup Operators group must have separate
    logon accounts for performing backup duties.
  resolution: Create separate accounts for backup operations for users with this privilege.
  query: '-- Manual check required: WN11-00-000075

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Software certificate installation files must be removed from Windows
    11.
  platforms: windows
  platform: windows
  description: Use of software certificates and their accompanying installation files
    for end users to access resources is less secure than the use of hardware-based
    certificates.
  resolution: 'Remove any certificate installation files (*.p12 and *.pfx) found on
    a system.  Note: This does not apply to server-based applications that have a
    requirement for .p12 certificate files (e.g., Oracle Wallet Manager) or Adobe
    PreFlight certificate files.'
  query: '-- Manual check required: WN11-00-000130

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Only authorized user accounts must be allowed to create or run virtual
    machines on Windows 11 systems.
  platforms: windows
  platform: windows
  description: Allowing other operating systems to run on a secure system may allow
    users to circumvent security. For Hyper-V, preventing unauthorized users from
    being assigned to the Hyper-V Administrators group will prevent them from accessing
    or creating virtual machines on the system. The Hyper-V Hypervisor is used by
    virtualization-based Security features such as Credential Guard on Windows 11;
    however, it is not the full Hyper-V installation.
  resolution: For Hyper-V, remove any unauthorized groups or user accounts from the
    "Hyper-V Administrators" group.  For hosted hypervisors other than Hyper-V, restrict
    access to create or run virtual machines to authorized user accounts only.
  query: '-- Manual check required: WN11-00-000080

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Standard local user accounts must not exist on a system in a domain.
  platforms: windows
  platform: windows
  description: To minimize potential points of attack, local user accounts, other
    than built-in accounts and local administrator accounts, must not exist on a workstation
    in a domain. Users must log on to workstations in a domain with their domain accounts.
  resolution: Limit local user accounts on domain-joined systems. Remove any unauthorized
    local accounts.
  query: '-- Manual check required: WN11-00-000085

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Accounts must be configured to require password expiration.
  platforms: windows
  platform: windows
  description: Passwords that do not expire increase exposure with a greater probability
    of being discovered or cracked.
  resolution: Configure all passwords to expire. Run "Computer Management". Navigate
    to System Tools >> Local Users and Groups >> Users. Double-click each active account.
    Ensure "Password never expires" is not checked on all active accounts.
  query: '-- Manual check required: WN11-00-000090

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Permissions for system files and directories must conform to minimum
    requirements.
  platforms: windows
  platform: windows
  description: Changing the system's file and directory permissions allows the possibility
    of unauthorized and anonymous modification to the operating system and installed
    applications.
  resolution: 'Maintain the default file system permissions and configure the Security
    Option: "Network access: Let everyone permissions apply to anonymous users" to
    "Disabled" (WN11-SO-000160).'
  query: '-- Manual check required: WN11-00-000095

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Internet Information System (IIS) or its subcomponents must not be
    installed on a workstation.
  platforms: windows
  platform: windows
  description: IIS is not installed by default. Installation of Internet Information
    System (IIS) may allow unauthorized internet services to be hosted. Websites must
    only be hosted on servers that have been designed for that purpose and can be
    adequately secured.
  resolution: Uninstall "Internet Information Services" or "Internet Information Services
    Hostable Web Core" from the system.
  query: '-- Manual check required: WN11-00-000100

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Simple Network Management Protocol (SNMP) must not be installed on
    the system.
  platforms: windows
  platform: windows
  description: '"SNMP" is not installed by default. Some protocols and services do
    not support required security features, such as encrypting passwords or traffic.'
  resolution: Uninstall "Simple Network Management Protocol (SNMP)" from the system.  Run
    "Programs and Features". Select "Turn Windows Features on or off". De-select "Simple
    Network Management Protocol (SNMP)".
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path = 'C:\Windows\System32\snmp.exe')
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisableSnmp.ps1
---
apiVersion: v1
kind: policy
spec:
  name: STIG - Simple TCP/IP Services must not be installed on the system.
  platforms: windows
  platform: windows
  description: '"Simple TCP/IP Services" is not installed by default. Some protocols
    and services do not support required security features, such as encrypting passwords
    or traffic.'
  resolution: Uninstall "Simple TCPIP Services (i.e. echo, daytime etc.)" from the
    system.  Run "Programs and Features". Select "Turn Windows Features on or off".
    De-select "Simple TCPIP Services (i.e. echo, daytime etc.)".
  query: '-- Manual check required: WN11-00-000110

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Inbound exceptions to the firewall on Windows 11 domain workstations
    must only allow authorized remote management hosts.
  platforms: windows
  platform: windows
  description: Allowing inbound access to domain workstations from other systems may
    allow lateral movement across systems if credentials are compromised. Limiting
    inbound connections only from authorized remote management systems will help limit
    this exposure.
  resolution: Configure firewall exceptions to inbound connections on domain workstations
    to include only authorized remote management hosts.  Configure only inbound connection
    exceptions for authorized remote management hosts. Computer Configuration >> Windows
    Settings >> Security Settings >> Windows Defender Firewall with Advanced Security
    >> Windows Defender Firewall with Advanced Security >> Inbound Rules (this link
    will be in the right pane)  For any inbound rules that allow connections, configure
    the...
  query: '-- Manual check required: WN11-00-000140

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Data Execution Prevention (DEP) must be configured to at least OptOut.
  platforms: windows
  platform: windows
  description: Attackers are constantly looking for vulnerabilities in systems and
    applications. Data Execution Prevention (DEP) prevents harmful code from running
    in protected memory locations reserved for Windows and other programs.
  resolution: 'Configure DEP to at least OptOut.  Note: Suspend BitLocker before making
    changes to the DEP configuration.  Open a command prompt (cmd.exe) or PowerShell
    with elevated privileges (Run as administrator). Enter "BCDEDIT /set {current}
    nx OptOut". (If using PowerShell "{current}" must be enclosed in quotes.) "AlwaysOn",
    a more restrictive selection, is also valid but does not allow applications that
    do not function properly to be opted out of DEP.  Opted out exceptions can be
    configured in the "...'
  query: '-- Manual check required: WN11-00-000145

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Structured Exception Handling Overwrite Protection (SEHOP) must be
    enabled.
  platforms: windows
  platform: windows
  description: Attackers are constantly looking for vulnerabilities in systems and
    applications. Structured Exception Handling Overwrite Protection (SEHOP) blocks
    exploits that use the Structured Exception Handling overwrite technique, a common
    buffer overflow attack.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> MS Security Guide >> "Enable Structured Exception Handling Overwrite
    Protection (SEHOP)" to "Enabled".  This policy setting requires the installation
    of the SecGuide custom templates included with the STIG package. "SecGuide.admx"
    and "SecGuide.adml" must be copied to the \Windows\PolicyDefinitions and \Windows\PolicyDefinitions\en-US
    directories respectively.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\kernel\DisableExceptionChainValidation' AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: DisableExceptionChainValidation.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows PowerShell 2.0 feature must be disabled on the system.
  platforms: windows
  platform: windows
  description: Windows PowerShell 5.0 added advanced logging features which can provide
    additional detail when malware has been run on a system. Disabling the Windows
    PowerShell 2.0 mitigates against a downgrade attack that evades the Windows PowerShell
    5.0 script block logging feature.
  resolution: 'Disable "Windows PowerShell 2.0" on the system.  Run "Windows PowerShell"
    with elevated privileges (run as administrator). Enter the following: Disable-WindowsOptionalFeature
    -Online -FeatureName MicrosoftWindowsPowerShellV2Root  This command must disable
    both "MicrosoftWindowsPowerShellV2Root" and "MicrosoftWindowsPowerShellV2" which
    correspond to "Windows PowerShell 2.0" and "Windows PowerShell 2.0 Engine" respectively
    in "Turn Windows features on or off".  Alternately: Search for "Features...'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PowerShell\3\PowerShellEngine\PowerShellVersion'
    AND data >= '2');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: None - depreciated. Updated query.

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The password history must be configured to 24 passwords remembered.
  platforms: windows
  platform: windows
  description: A system is more vulnerable to unauthorized access when system users
    recycle the same password several times without being required to change a password
    to a unique password on a regularly scheduled basis. This enables users to effectively
    negate the purpose of mandating periodic password changes. The default value is
    24 for Windows domain systems. DOD has decided this is the appropriate value for
    all Windows systems.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Password Policy >> "Enforce password
    history" to "24" passwords remembered.
  query: '-- Manual check required: WN11-AC-000020

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PasswordRequirements.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Server Message Block (SMB) v1 protocol must be disabled on the
    system.
  platforms: windows
  platform: windows
  description: SMBv1 is a legacy protocol that uses the MD5 algorithm as part of SMB.
    MD5 is known to be vulnerable to a number of attacks such as collision and preimage
    attacks as well as not being FIPS compliant.  Disabling SMBv1 support may prevent
    access to file or print sharing resources with systems or devices that only support
    SMBv1. File shares and print services hosted on Windows Server 2003 are an example,
    however Windows Server 2003 is no longer a supported operating system. Some older
    Network At...
  resolution: 'Disable the SMBv1 protocol.  Run "Windows PowerShell" with elevated
    privileges (run as administrator).  Enter the following: Disable-WindowsOptionalFeature
    -Online -FeatureName SMB1Protocol  Alternately: Search for "Features".  Select
    "Turn Windows features on or off".  De-select "SMB 1.0/CIFS File Sharing Support".'
  query: '-- Manual check required: WN11-00-000160

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Server Message Block (SMB) v1 protocol must be disabled on the
    SMB server.
  platforms: windows
  platform: windows
  description: SMBv1 is a legacy protocol that uses the MD5 algorithm as part of SMB.
    MD5 is known to be vulnerable to a number of attacks such as collision and preimage
    attacks as well as not being FIPS compliant.  Disabling SMBv1 support may prevent
    access to file or print sharing resources with systems or devices that only support
    SMBv1. File shares and print services hosted on Windows Server 2003 are an example,
    however Windows Server 2003 is no longer a supported operating system. Some older
    network at...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> MS Security Guide >> "Configure SMBv1 Server" to "Disabled".  This
    policy setting requires the installation of the SecGuide custom templates included
    with the STIG package. "SecGuide.admx" and "SecGuide.adml" must be copied to the
    \Windows\PolicyDefinitions and \Windows\PolicyDefinitions\en-US directories, respectively.    The
    system must be restarted for the change to take effect.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\SMB1'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Server Message Block (SMB) v1 protocol must be disabled on the
    SMB client.
  platforms: windows
  platform: windows
  description: SMBv1 is a legacy protocol that uses the MD5 algorithm as part of SMB.
    MD5 is known to be vulnerable to a number of attacks such as collision and preimage
    attacks as well as not being FIPS compliant.  Disabling SMBv1 support may prevent
    access to file or print sharing resources with systems or devices that only support
    SMBv1. File shares and print services hosted on Windows Server 2003 are an example,
    however Windows Server 2003 is no longer a supported operating system. Some older
    network at...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> MS Security Guide >> "Configure SMBv1 client driver" to "Enabled"
    with "Disable driver (recommended)" selected for "Configure MrxSmb10 driver".  This
    policy setting requires the installation of the SecGuide custom templates included
    with the STIG package. "SecGuide.admx" and "SecGuide.adml" must be copied to the
    \Windows\PolicyDefinitions and \Windows\PolicyDefinitions\en-US directories, respectively.    The
    ...
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\mrxsmb10\Start'
    AND data = '4');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Secondary Logon service must be disabled on Windows 11.
  platforms: windows
  platform: windows
  description: The Secondary Logon service provides a means for entering alternate
    credentials, typically used to run commands with elevated privileges. Using privileged
    credentials in a standard user session can expose those credentials to theft.
  resolution: Configure the "Secondary Logon" service "Startup Type" to "Disabled".
  query: '-- Manual check required: WN11-00-000175

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Orphaned security identifiers (SIDs) must be removed from user rights
    on Windows 11.
  platforms: windows
  platform: windows
  description: Accounts or groups given rights on a system may show up as unresolved
    SIDs for various reasons including deletion of the accounts or groups. If the
    account or group objects are reanimated, there is a potential they may still have
    rights no longer intended. Valid domain accounts or groups may also show up as
    unresolved SIDs if a connection to the domain cannot be established for some reason.
  resolution: Remove any unresolved SIDs found in User Rights assignments and determined
    to not be for currently valid accounts or groups by removing the accounts or groups
    from the appropriate group policy.
  query: '-- Manual check required: WN11-00-000190

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Administrative accounts must not be used with applications that access
    the internet, such as web browsers, or with potential internet sources, such as
    email.
  platforms: windows
  platform: windows
  description: Using applications that access the internet or have potential internet
    sources using administrative privileges exposes a system to compromise. If a flaw
    in an application is exploited while running as a privileged user, the entire
    system could be compromised. Web browsers and email are common attack vectors
    for introducing malicious code and must not be run with an administrative account.  Since
    administrative accounts may generally change or work around technical restrictions
    for running a w...
  resolution: Establish and enforce a policy that prohibits administrative accounts
    from using applications that access the internet, such as web browsers, or with
    potential internet sources, such as email. Define specific exceptions for local
    service administration. These exceptions may include HTTP(S)-based tools that
    are used for the administration of the local system, services, or attached devices.  Implement
    technical measures where feasible such as removal of applications or use of application
    allowl...
  query: '-- Manual check required: WN11-00-000240

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 nonpersistent VM sessions must not exceed 24 hours.
  platforms: windows
  platform: windows
  description: For virtual desktop implementations (VDIs) where the virtual desktop
    instance is deleted or refreshed upon logoff, the organization must enforce that
    sessions be terminated within 24 hours. This would ensure any data stored on the
    VM that is not encrypted or covered by Credential Guard is deleted.
  resolution: Set nonpersistent VM sessions to not exceed 24 hours.
  query: '-- Manual check required: WN11-00-000250

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows 11 time service must synchronize with an appropriate DOD
    time source.
  platforms: windows
  platform: windows
  description: The Windows Time Service controls time synchronization settings. Time
    synchronization is essential for authentication and auditing purposes. If the
    Windows Time Service is used, it must synchronize with a secure, authorized time
    source. Domain-joined systems are automatically configured to synchronize with
    domain controllers. If an NTP server is configured, it must synchronize with a
    secure, authorized time source.
  resolution: Configure the system to synchronize time with an appropriate DOD time
    source.  Domain-joined systems use NT5DS to synchronize time from other systems
    in the domain by default.  If the system needs to be configured to an NTP server,
    configure the system to point to an authorized time server by setting the policy
    value for Computer Configuration >> Administrative Templates >> System >> Windows
    Time Service >> Time Providers >> "Configure Windows NTP Client" to "Enabled",
    and configure the "NtpS...
  query: '-- Manual check required: WN11-00-000260

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 account lockout duration must be configured to 15 minutes
    or greater.
  platforms: windows
  platform: windows
  description: The account lockout feature, when enabled, prevents brute-force password
    attacks on the system. This parameter specifies the amount of time that an account
    will remain locked after the specified number of failed logon attempts.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Account Lockout Policy >> "Account
    lockout duration" to "15" minutes or greater.  A value of "0" is also acceptable,
    requiring an administrator to unlock the account.
  query: '-- Manual check required: WN11-AC-000005

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PasswordRequirements.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The number of allowed bad logon attempts must be configured to three
    or less.
  platforms: windows
  platform: windows
  description: The account lockout feature, when enabled, prevents brute-force password
    attacks on the system. The higher this value is, the less effective the account
    lockout feature will be in protecting the local system. The number of bad logon
    attempts must be reasonably small to minimize the possibility of a successful
    password attack, while allowing for honest errors made during a normal user logon.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Account Lockout Policy >> "Account
    lockout threshold" to "3" or less invalid logon attempts (excluding "0" which
    is unacceptable).
  query: '-- Manual check required: WN11-AC-000010

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The maximum password age must be configured to 60 days or less.
  platforms: windows
  platform: windows
  description: The longer a password is in use, the greater the opportunity for someone
    to gain unauthorized knowledge of the passwords. Scheduled changing of passwords
    hinders the ability of unauthorized system users to crack passwords and gain access
    to a system.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Password Policy >> "Maximum Password
    Age" to "60" days or less (excluding "0" which is unacceptable).
  query: '-- Manual check required: WN11-AC-000025

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PasswordRequirements.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The minimum password age must be configured to at least 1 day.
  platforms: windows
  platform: windows
  description: Permitting passwords to be changed in immediate succession within the
    same day allows users to cycle passwords through their history database. This
    enables users to effectively negate the purpose of mandating periodic password
    changes.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Password Policy >> "Minimum Password
    Age" to at least "1" day.
  query: '-- Manual check required: WN11-AC-000030

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PasswordRequirements.xml
---
apiVersion: v1
kind: policy
spec:
  name: STIG - Passwords must, at a minimum, be 14 characters.
  platforms: windows
  platform: windows
  description: Information systems not protected with strong password schemes (including
    passwords of minimum length) provide the opportunity for anyone to crack the password,
    thus gaining access to the system and compromising the device, information, or
    the local network.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Password Policy >> "Minimum password
    length" to "14" characters.
  query: '-- Manual check required: WN11-AC-000035

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PasswordRequirements.xml
---
apiVersion: v1
kind: policy
spec:
  name: STIG - The built-in Microsoft password complexity filter must be enabled.
  platforms: windows
  platform: windows
  description: The use of complex passwords increases their strength against guessing
    and brute-force attacks. This setting configures the system to verify that newly
    created passwords conform to the Windows password complexity policy.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Password Policy >> "Password must
    meet complexity requirements" to "Enabled".
  query: '-- Manual check required: WN11-AC-000040

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PasswordRequirements.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Reversible password encryption must be disabled.
  platforms: windows
  platform: windows
  description: Storing passwords using reversible encryption is essentially the same
    as storing clear-text versions of the passwords. For this reason, this policy
    must never be enabled.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Account Policies >> Password Policy >> "Store passwords
    using reversible encryption" to "Disabled".
  query: '-- Manual check required: WN11-AC-000045

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Account Logon - Credential Validation
    failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Credential validation records events
    related to validati...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Account Logon >> "Audit Credential Validation" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000005

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Anonymous enumeration of shares must be restricted.
  platforms: windows
  platform: windows
  description: Allowing anonymous logon users (null session connections) to list all
    account names and enumerate all shared resources can provide a map of potential
    points to attack the system.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network access:
    Do not allow anonymous enumeration of SAM accounts and shares" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\restrictanonymous'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: restrictanonymous.ps1


---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Account Logon - Credential Validation
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Credential validation records events
    related to validati...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Account Logon >> "Audit Credential Validation" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000010

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Account Management - Security
    Group Management successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Security Group Management records
    events such as creatin...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Account Management >> "Audit Security Group Management" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000030

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Account Management - User Account
    Management failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  User Account Management records
    events such as creating,...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Account Management >> "Audit User Account Management" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000035

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Account Management - User Account
    Management successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  User Account Management records
    events such as creating,...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Account Management >> "Audit User Account Management" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000040

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The System event log size must be configured to 32768 KB or greater.
  platforms: windows
  platform: windows
  description: Inadequate log size will cause the log to fill up quickly. This may
    prevent audit events from being recorded properly and require frequent attention
    by administrative personnel.
  resolution: If the system is configured to send audit records directly to an audit
    server, this is NA. This must be documented with the ISSO.  Configure the policy
    value for Computer Configuration >> Administrative Templates >> Windows Components
    >> Event Log Service >> System >> "Specify the maximum log file size (KB)" to
    "Enabled" with a "Maximum Log Size (KB)" of "32768" or greater.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\System\MaxSize'
    AND CAST(data AS INTEGER) >= 32768);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Detailed Tracking - PNP Activity
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Plug and Play activity records events
    related to the suc...
  resolution: Computer Configuration >> Windows Settings >> Advanced Audit Policy
    Configuration >> System Audit Policies >> Detailed Tracking >> "Audit PNP Activity"
    with "Success" selected.
  query: '-- Manual check required: WN11-AU-000045

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Detailed Tracking - Process
    Creation successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Process creation records events
    related to the creation ...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Detailed Tracking >> "Audit Process Creation" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000050

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Logon/Logoff - Account Lockout
    failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Account Lockout events can be used
    to identify potential...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Logon/Logoff >> "Audit Account Lockout" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000054

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Logon/Logoff - Group Membership
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Group Membership records information
    related to th...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Advanced Audit Policy Configuration >> System Audit Policies >> Logon/Logoff
    >> "Audit Group Membership" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000060

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit System - System Integrity failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  System Integrity records events
    related to violations of...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> System >> "Audit System Integrity" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000155

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Logon/Logoff - Logoff successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Logoff records user logoffs. If
    this is an interactive l...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Logon/Logoff >> "Audit Logoff" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000065

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Logon/Logoff - Logon failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Logon records user logons. If this
    is an interactive log...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Logon/Logoff >> "Audit Logon" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000070

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Logon/Logoff - Logon successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Logon records user logons. If this
    is an interactive log...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Logon/Logoff >> "Audit Logon" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000075

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Logon/Logoff - Special Logon
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Special Logon records special logons
    which have administ...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Logon/Logoff >> "Audit Special Logon" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000080

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to prevent Internet Control Message Protocol
    (ICMP) redirects from overriding Open Shortest Path First (OSPF) generated routes.
  platforms: windows
  platform: windows
  description: Allowing ICMP redirect of routes can lead to traffic not being routed
    properly.  When disabled, this forces ICMP to be routed via shortest path first.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> MSS (Legacy) >> "MSS: (EnableICMPRedirect) Allow ICMP redirects to
    override OSPF generated routes" to "Disabled".  This policy setting requires the
    installation of the MSS-Legacy custom templates included with the STIG package.
    "MSS-Legacy.admx" and "MSS-Legacy.adml" must be copied to the \Windows\PolicyDefinitions
    and \Windows\PolicyDefinitions\en-US directories respectively.'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\EnableICMPRedirect'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit Object Access - File Share failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Auditing file shares records events
    related to connectio...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Object Access >> "Audit File Share" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000081

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit Object Access - File Share successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Auditing file shares records events
    related to connectio...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Object Access >> "Audit File Share" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000082

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit Object Access - Other Object
    Access Events successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Auditing for other object access
    records events related ...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Object Access >> "Audit Other Object Access Events" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000083

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit Object Access - Other Object
    Access Events failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Auditing for other object access
    records events related ...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Object Access >> "Audit Other Object Access Events" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000084

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to enable Remote host allows delegation
    of non-exportable credentials.
  platforms: windows
  platform: windows
  description: An exportable version of credentials is provided to remote hosts when
    using credential delegation which exposes them to theft on the remote host. Restricted
    Admin mode or Remote Credential Guard allow delegation of non-exportable credentials
    providing additional protection of the credentials. Enabling this configures the
    host to support Restricted Admin mode or Remote Credential Guard.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Credentials Delegation >> "Remote host allows delegation
    of non-exportable credentials" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation\AllowProtectedCreds'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Object Access - Removable Storage
    failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Auditing object access for removable
    media records event...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Object Access >> "Audit Removable Storage" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000085

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Object Access - Removable Storage
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Auditing object access for removable
    media records event...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Object Access >> "Audit Removable Storage" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000090

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Policy Change - Audit Policy
    Change successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Policy Change records events
    related to changes in...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Policy Change >> "Audit Policy Change" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000100

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Policy Change - Authentication
    Policy Change successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Authentication Policy Change records
    events related to c...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Policy Change >> "Audit Authentication Policy Change" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000105

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit System - System Integrity successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  System Integrity records events
    related to violations of...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> System >> "Audit System Integrity" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000160

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Policy Change - Authorization
    Policy Change successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Authorization Policy Change records
    events related to ch...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Policy Change >> "Audit Authorization Policy Change" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000107

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Privilege Use - Sensitive Privilege
    Use failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Sensitive Privilege Use records
    events related to use of...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Privilege Use >> "Audit Sensitive Privilege Use" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000110

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit Privilege Use - Sensitive Privilege
    Use successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Sensitive Privilege Use records
    events related to use of...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Privilege Use >> "Audit Sensitive Privilege Use" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000115

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit System - IPsec Driver failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  IPsec Driver records events related
    to the IPsec Driver ...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> System >> "Audit IPsec Driver" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000120

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Application event log size must be configured to 32768 KB or greater.
  platforms: windows
  platform: windows
  description: Inadequate log size will cause the log to fill up quickly. This may
    prevent audit events from being recorded properly and require frequent attention
    by administrative personnel.
  resolution: If the system is configured to send audit records directly to an audit
    server, this is NA. This must be documented with the ISSO.  Configure the policy
    value for Computer Configuration >> Administrative Templates >> Windows Components
    >> Event Log Service >> Application >> "Specify the maximum log file size (KB)"
    to "Enabled" with a "Maximum Log Size (KB)" of "32768" or greater.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application\MaxSize'
    AND CAST(data AS INTEGER) >= 32768);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit System - Other System Events
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Other System Events records
    information related to...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> System >> "Audit Other System Events" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000130

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit System - Other System Events
    failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Other System Events records
    information related to...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> System >> "Audit Other System Events" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000135

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit System - Security State Change
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Security State Change records events
    related to changes ...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> System >> "Audit Security State Change" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000140

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to audit System - Security System Extension
    successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Security System Extension records
    events related to exte...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> System >> "Audit Security System Extension" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000150

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Security event log size must be configured to 1024000 KB or greater.
  platforms: windows
  platform: windows
  description: Inadequate log size will cause the log to fill up quickly. This may
    prevent audit events from being recorded properly and require frequent attention
    by administrative personnel.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Event Log Service >> Security >> "Specify the
    maximum log file size (KB)" to "Enabled" with a "Maximum Log Size (KB)" of "1024000"
    or greater.  If the system is configured to send audit records directly to an
    audit server, this must be documented with the ISSO.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security\MaxSize'
    AND CAST(data AS INTEGER) >= 1024000);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 permissions for the Application event log must prevent access
    by non-privileged accounts.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. The Application
    event log may be susceptible to tampering if proper permissions are not applied.
  resolution: Ensure the permissions on the Application event log (Application.evtx)
    are configured to prevent standard user accounts or groups from having access.
    The default permissions listed below satisfy this requirement.  Eventlog - Full
    Control SYSTEM - Full Control Administrators - Full Control  The default location
    is the "%SystemRoot%\SYSTEM32\WINEVT\LOGS" directory.  If the location of the
    logs has been changed, when adding Eventlog to the permissions, it must be entered
    as "NT Service\Eventlog".
  query: '-- Manual check required: WN11-AU-000515

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 permissions for the Security event log must prevent access
    by non-privileged accounts.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. The Security
    event log may disclose sensitive information or be susceptible to tampering if
    proper permissions are not applied.
  resolution: Ensure the permissions on the Security event log (Security.evtx) are
    configured to prevent standard user accounts or groups from having access. The
    default permissions listed below satisfy this requirement.  Eventlog - Full Control
    SYSTEM - Full Control Administrators - Full Control  The default location is the
    "%SystemRoot%\SYSTEM32\WINEVT\LOGS" directory.  If the location of the logs has
    been changed, when adding Eventlog to the permissions, it must be entered as "NT
    Service\Eventlog".
  query: '-- Manual check required: WN11-AU-000520

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 permissions for the System event log must prevent access
    by non-privileged accounts.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. The System event
    log may be susceptible to tampering if proper permissions are not applied.
  resolution: Ensure the permissions on the System event log (System.evtx) are configured
    to prevent standard user accounts or groups from having access. The default permissions
    listed below satisfy this requirement.  Eventlog - Full Control SYSTEM - Full
    Control Administrators - Full Control  The default location is the "%SystemRoot%\SYSTEM32\WINEVT\LOGS"
    directory.  If the location of the logs has been changed, when adding Eventlog
    to the permissions, it must be entered as "NT Service\Eventlog".
  query: '-- Manual check required: WN11-AU-000525

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit Other Policy Change Events Successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Other Policy Change Events
    contains events about E...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Policy Change>> "Audit Other Policy Change Events" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000550

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit Other Policy Change Events Failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Other Policy Change Events
    contains events about E...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Policy Change>> "Audit Other Policy Change Events" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000555

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit other Logon/Logoff Events Successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Other Logon/Logoff Events
    determines whether Windo...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Logon/Logoff >> "Audit Other Logon/Logoff Events" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000560

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit other Logon/Logoff Events Failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Other Logon/Logoff Events
    determines whether Windo...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Logon/Logoff >> "Audit Other Logon/Logoff Events" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000565

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit Detailed File Share Failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit Detailed File Share allows
    the user to audit attem...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Object Access >> Audit Detailed File Share" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000570

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit MPSSVC Rule-Level Policy Change
    Successes.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit MPSSVC Rule-Level Policy Change
    determines whether...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Policy Change >> Audit MPSSVC Rule-Level Policy Change" with "Success" selected.
  query: '-- Manual check required: WN11-AU-000575

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to audit MPSSVC Rule-Level Policy Change
    Failures.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Audit MPSSVC Rule-Level Policy Change
    determines whether...
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Advanced Audit Policy Configuration >> System Audit Policies
    >> Policy Change >> Audit MPSSVC Rule-Level Policy Change" with "Failure" selected.
  query: '-- Manual check required: WN11-AU-000580

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Camera access from the lock screen must be disabled.
  platforms: windows
  platform: windows
  description: Enabling camera access from the lock screen could allow for unauthorized
    use. Requiring logon will ensure the device is only used by authorized personnel.
  resolution: If the device does not have a camera, this is NA.  Configure the policy
    value for Computer Configuration >> Administrative Templates >> Control Panel
    >> Personalization >> "Prevent enabling lock screen camera" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization\NoLockScreenCamera'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must cover or disable the built-in or attached camera when
    not in use.
  platforms: windows
  platform: windows
  description: It is detrimental for operating systems to provide, or install by default,
    functionality exceeding requirements or mission objectives. These unnecessary
    capabilities or services are often overlooked and therefore may remain unsecured.
    They increase the risk to the platform by providing additional attack vectors.  Failing
    to disconnect from collaborative computing devices (i.e. cameras) can result in
    subsequent compromises of organizational information. Providing easy methods to
    physically dis...
  resolution: 'If the camera is not disconnected or covered, the following registry
    entry is required.   Registry Hive: HKEY_LOCAL_MACHINE RegistryPath\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam  Value
    Name: Value                                                                            Value
    Data: Deny'
  query: '-- Manual check required: WN11-CC-000007

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The display of slide shows on the lock screen must be disabled.
  platforms: windows
  platform: windows
  description: Slide shows that are displayed on the lock screen could display sensitive
    information to unauthorized personnel. Turning off this feature will limit access
    to the information to a logged on user.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Control Panel >> Personalization >> "Prevent enabling lock screen
    slide show" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization\321'
    AND data = '1');
  purpose: Informational2
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PreventLockScreenSlideShow.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - IPv6 source routing must be configured to highest protection.
  platforms: windows
  platform: windows
  description: Configuring the system to disable IPv6 source routing protects against
    spoofing.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> MSS (Legacy) >> "MSS: (DisableIPSourceRouting IPv6) IP source routing
    protection level (protects against packet spoofing)" to "Highest protection, source
    routing is completely disabled".  This policy setting requires the installation
    of the MSS-Legacy custom templates included with the STIG package. "MSS-Legacy.admx"
    and "MSS-Legacy.adml" must be copied to the \Windows\PolicyDefinitions and \Windows\PolicyDef...'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\DisableIpSourceRouting'
    AND data = '2');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to prevent IP source routing.
  platforms: windows
  platform: windows
  description: Configuring the system to disable IP source routing protects against
    spoofing.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> MSS (Legacy) >> "MSS: (DisableIPSourceRouting) IP source routing
    protection level (protects against packet spoofing)" to "Highest protection, source
    routing is completely disabled".  This policy setting requires the installation
    of the MSS-Legacy custom templates included with the STIG package. "MSS-Legacy.admx"
    and "MSS-Legacy.adml" must be copied to the \Windows\PolicyDefinitions and \Windows\PolicyDefiniti...'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\DisableIPSourceRouting'
    AND data = '2');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to ignore NetBIOS name release requests
    except from WINS servers.
  platforms: windows
  platform: windows
  description: Configuring the system to ignore name release requests, except from
    WINS servers, prevents a denial of service (DoS) attack. The DoS consists of sending
    a NetBIOS name release request to the server for each entry in the server's cache,
    causing a response delay in the normal operation of the servers WINS resolution
    capability.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> MSS (Legacy) >> "MSS: (NoNameReleaseOnDemand) Allow the computer
    to ignore NetBIOS name release requests except from WINS servers" to "Enabled".  This
    policy setting requires the installation of the MSS-Legacy custom templates included
    with the STIG package. "MSS-Legacy.admx" and "MSS-Legacy.adml" must be copied
    to the \Windows\PolicyDefinitions and \Windows\PolicyDefinitions\en-US directories
    respectively.'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netbt\Parameters\NoNameReleaseOnDemand'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Local administrator accounts must have their privileged token filtered
    to prevent elevated privileges from being used over the network on domain systems.
  platforms: windows
  platform: windows
  description: A compromised local administrator account can provide means for an
    attacker to move laterally between domain systems.  With User Account Control
    enabled, filtering the privileged token for built-in administrator accounts will
    prevent the elevated privileges of these accounts from being used over the network.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> MS Security Guide >> "Apply UAC restrictions to local accounts on
    network logons" to "Enabled".  This policy setting requires the installation of
    the SecGuide custom templates included with the STIG package. "SecGuide.admx"
    and "SecGuide.adml" must be copied to the \Windows\PolicyDefinitions and \Windows\PolicyDefinitions\en-US
    directories respectively.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - WDigest Authentication must be disabled.
  platforms: windows
  platform: windows
  description: When the WDigest Authentication protocol is enabled, plain text passwords
    are stored in the Local Security Authority Subsystem Service (LSASS) exposing
    them to theft. WDigest is disabled by default in Windows 11. This setting ensures
    this is enforced.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> MS Security Guide >> "WDigest Authentication (disabling may require
    KB2871997)" to "Disabled".  The patch referenced in the policy title is not required
    for Windows 11.  This policy setting requires the installation of the SecGuide
    custom templates included with the STIG package. "SecGuide.admx" and "SecGuide.adml"
    must be copied to the \Windows\PolicyDefinitions and \Windows\PolicyDefinitions\en-US
    directori...
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Wdigest\UseLogonCredential'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Run as different user must be removed from context menus.
  platforms: windows
  platform: windows
  description: The "Run as different user" selection from context menus allows the
    use of credentials other than the currently logged on user. Using privileged credentials
    in a standard user session can expose those credentials to theft. Removing this
    option from context menus helps prevent this from occurring.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> MS Security Guide >> "Remove "Run as Different User" from context
    menus" to "Enabled".  This policy setting requires the installation of the SecGuide
    custom templates included with the STIG package. "SecGuide.admx" and "SecGuide.adml"
    must be copied to the \Windows\PolicyDefinitions and \Windows\PolicyDefinitions\en-US
    directories respectively.
  query: '-- Manual check required: WN11-CC-000039

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Insecure logons to an SMB server must be disabled.
  platforms: windows
  platform: windows
  description: Insecure guest logons allow unauthenticated access to shared folders.
    Shared resources on a system must require authentication to establish proper access.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Network >> Lanman Workstation >> "Enable insecure guest logons" to
    "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\LanmanWorkstation\AllowInsecureGuestAuth'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Internet connection sharing must be disabled.
  platforms: windows
  platform: windows
  description: Internet connection sharing makes it possible for an existing internet
    connection, such as through wireless, to be shared and used by other systems essentially
    creating a mobile hotspot. This exposes the system sharing the connection to others
    with potentially malicious purpose.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Network >> Network Connections >> "Prohibit use of Internet Connection
    Sharing on your DNS domain network" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Network
    Connections\NC_ShowSharedAccessUI' AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Hardened UNC Paths must be defined to require mutual authentication
    and integrity for at least the \\*\SYSVOL and \\*\NETLOGON shares.
  platforms: windows
  platform: windows
  description: Additional security requirements are applied to Universal Naming Convention
    (UNC) paths specified in Hardened UNC paths before allowing access them. This
    aids in preventing tampering with or spoofing of connections to these paths.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> Network >> Network Provider >> "Hardened UNC Paths" to "Enabled"
    with at least the following configured in "Hardened UNC Paths:" (click the "Show"
    button to display).  Value Name: \\*\SYSVOL Value: RequireMutualAuthentication=1,
    RequireIntegrity=1  Value Name: \\*\NETLOGON Value: RequireMutualAuthentication=1,
    RequireIntegrity=1'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths\\\*\NETLOGON'
    AND data = 'RequireMutualAuthentication=1, RequireIntegrity=1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to prioritize ECC Curves with longer
    key lengths first.
  platforms: windows
  platform: windows
  description: Use of weak or untested encryption algorithms undermines the purposes
    of utilizing encryption to protect data. By default Windows uses ECC curves with
    shorter key lengths first. Requiring ECC curves with longer key lengths to be
    prioritized first helps ensure more secure algorithms are used.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> Network >> SSL Configuration Settings >> "ECC Curve Order" to "Enabled"
    with "ECC Curve Order:" including the following in the order listed:  NistP384
    NistP256'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002\EccCurves'
    AND data != '' AND LENGTH(data) > 0);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Simultaneous connections to the internet or a Windows domain must be
    limited.
  platforms: windows
  platform: windows
  description: Multiple network connections can provide additional attack vectors
    to a system and must be limited. The "Minimize the number of simultaneous connections
    to the Internet or a Windows Domain" setting prevents systems from automatically
    establishing multiple connections. When both wired and wireless connections are
    available, for example, the less preferred connection (typically wireless) will
    be disconnected.
  resolution: The default behavior for "Minimize the number of simultaneous connections
    to the Internet or a Windows Domain" is "Enabled".  If this needs to be corrected,
    configure the policy value for Computer Configuration >> Administrative Templates
    >> Network >> Windows Connection Manager >> "Minimize the number of simultaneous
    connections to the Internet or a Windows Domain" to "Enabled".  Under "Options",
    set "Minimize Policy Options" to "3 = Prevent Wi-Fi When on Ethernet".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy\fMinimizeConnections'
    AND data = '3 (or if the Value Name does not exist)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Connections to non-domain networks when connected to a domain authenticated
    network must be blocked.
  platforms: windows
  platform: windows
  description: Multiple network connections can provide additional attack vectors
    to a system and must be limited. When connected to a domain, communication must
    go through the domain connection.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Network >> Windows Connection Manager >> "Prohibit connection to
    non-domain networks when connected to domain authenticated network" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy\fBlockNonDomain'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Wi-Fi Sense must be disabled.
  platforms: windows
  platform: windows
  description: Wi-Fi Sense automatically connects the system to known hotspots and
    networks that contacts have shared. It also allows the sharing of the system's
    known networks to contacts. Automatically connecting to hotspots and shared networks
    can expose a system to unsecured or potentially malicious systems.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Network >> WLAN Service >> WLAN Settings>> "Allow Windows to automatically
    connect to suggested open hotspots, to networks shared by contacts, and to hotspots
    offering paid services" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WcmSvc\wifinetworkmanager\config\AutoConnectAllowedOEM'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Command line data must be included in process creation events.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Enabling "Include command line data
    for process creation...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Audit Process Creation >> "Include command line in process
    creation events" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit\ProcessCreationIncludeCmdLine_Enabled'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: IncludeCmdLine.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Virtualization-based Security must be enabled on Windows 11 with the
    platform security level configured to Secure Boot or Secure Boot with DMA Protection.
  platforms: windows
  platform: windows
  description: Virtualization-based Security (VBS) provides the platform for the additional
    security features, Credential Guard and virtualization-based protection of code
    integrity. Secure Boot is the minimum security level with DMA protection providing
    additional memory protection. DMA Protection requires a CPU that supports input/output
    memory management unit (IOMMU).
  resolution: Virtualization-based security, including Credential Guard, currently
    cannot be implemented in virtual desktop implementations (VDI) due to specific
    supporting requirements including a TPM, UEFI with Secure Boot, and the capability
    to run the Hyper-V feature within the virtual desktop.  For VDIs where the virtual
    desktop instance is deleted or refreshed upon logoff, this is NA.  Configure the
    policy value for Computer Configuration >> Administrative Templates >> System
    >> Device Guard >> "Turn...
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\EnableVirtualizationBasedSecurity'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: EnableVirtualizationBasedSecurity.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Credential Guard must be running on Windows 11 domain-joined systems.
  platforms: windows
  platform: windows
  description: Credential Guard uses virtualization-based security to protect information
    that could be used in credential theft attacks if compromised. This authentication
    information, which was stored in the Local Security Authority (LSA) in previous
    versions of Windows, is isolated from the rest of operating system and can only
    be accessed by privileged system software.
  resolution: Virtualization-based security, including Credential Guard, currently
    cannot be implemented in virtual desktop implementations (VDI) due to specific
    supporting requirements including a TPM, UEFI with Secure Boot, and the capability
    to run the Hyper-V feature within the virtual desktop.  For VDIs where the virtual
    desktop instance is deleted or refreshed upon logoff, this is NA.  For VDIs with
    persistent desktops, this may be downgraded to a CAT II only where administrators
    have specific tokens...
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\LsaCfgFlags'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Virtualization-based protection of code integrity must be enabled.
  platforms: windows
  platform: windows
  description: Virtualization-based protection of code integrity enforces kernel mode
    memory protections as well as protecting Code Integrity validation paths. This
    isolates the processes from the rest of the operating system and can only be accessed
    by privileged system software.
  resolution: Virtualization-based security currently cannot be implemented in virtual
    desktop implementations (VDI) due to specific supporting requirements including
    a TPM, UEFI with Secure Boot, and the capability to run the Hyper-V feature within
    the virtual desktop.  For VDIs where the virtual desktop instance is deleted or
    refreshed upon logoff, this is NA.  Configure the policy value for Computer Configuration
    >> Administrative Templates >> System >> Device Guard >> "Turn On virtualization-based
    Secu...
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceGuard\HypervisorEnforcedCodeIntegrity'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: HypervisorEnforcedCodeIntegrity.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Early Launch Antimalware, Boot-Start Driver Initialization Policy must
    prevent boot drivers.
  platforms: windows
  platform: windows
  description: The default behavior is for Early Launch Antimalware - Boot-Start Driver
    Initialization policy is to enforce "Good, unknown and bad but critical" (preventing
    "bad"). By being launched first by the kernel, ELAM ( Early Launch Antimalware)
    is ensured to be launched before any third-party software, and is therefore able
    to detect malware in the boot process and prevent it from initializing.
  resolution: Ensure that Early Launch Antimalware - Boot-Start Driver Initialization
    policy is set to enforce "Good, unknown and bad but critical" (preventing "bad").  To
    correct this, configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Early Launch Antimalware >> "Boot-Start Driver Initialization
    Policy" to "Enabled with "Good, unknown and bad but critical" selected.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Policies\EarlyLaunch\DriverLoadPolicy'
    AND data = '1, 3, or 8');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: BootStartDriverInitialization.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Group Policy objects must be reprocessed even if they have not changed.
  platforms: windows
  platform: windows
  description: Enabling this setting and then selecting the "Process even if the Group
    Policy objects have not changed" option ensures that the policies will be reprocessed
    even if none have been changed. This way, any unauthorized changes are forced
    to match the domain-based group policy settings again.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Group Policy >> "Configure registry policy processing"
    to "Enabled" and select the option "Process even if the Group Policy objects have
    not changed".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Group
    Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}\NoGPOListChanges' AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Downloading print driver packages over HTTP must be prevented.
  platforms: windows
  platform: windows
  description: Some features may communicate with the vendor, sending system information
    or downloading data or components for the feature. Turning off this capability
    will prevent potentially sensitive information from being sent outside the enterprise
    and uncontrolled updates to the system. This setting prevents the computer from
    downloading print driver packages over HTTP.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Internet Communication Management >> Internet Communication
    settings >> "Turn off downloading of print drivers over HTTP" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path like 'HKEY_USERS\%\Software\Policies\Microsoft\Windows NT\Printers\DisableWebPnPDownload' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisableWebPnPDownload_1.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Web publishing and online ordering wizards must be prevented from downloading
    a list of providers.
  platforms: windows
  platform: windows
  description: Some features may communicate with the vendor, sending system information
    or downloading data or components for the feature. Turning off this capability
    will prevent potentially sensitive information from being sent outside the enterprise
    and uncontrolled updates to the system. This setting prevents Windows from downloading
    a list of providers for the Web publishing and online ordering wizards.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Internet Communication Management >> Internet Communication
    settings >> "Turn off Internet download for Web publishing and online ordering
    wizards" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoWebServices'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisableInternetDownloadForWebPublishingAndOnlineOrderingWizards.xml
---
apiVersion: v1
kind: policy
spec:
  name: STIG - Printing over HTTP must be prevented.
  platforms: windows
  platform: windows
  description: Some features may communicate with the vendor, sending system information
    or downloading data or components for the feature. Turning off this capability
    will prevent potentially sensitive information from being sent outside the enterprise
    and uncontrolled updates to the system. This setting prevents the client computer
    from printing over HTTP, which allows the computer to print to printers on the
    intranet as well as the internet.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Internet Communication Management >> Internet Communication
    settings >> "Turn off printing over HTTP" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Policies\Microsoft\Windows NT\Printers\DisableHTTPPrinting' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisablePrintingOverHTTP.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Systems must at least attempt device authentication using certificates.
  platforms: windows
  platform: windows
  description: Using certificates to authenticate devices to the domain provides increased
    security over passwords. By default systems will attempt to authenticate using
    certificates and fall back to passwords if the domain controller does not support
    certificates for devices. This may also be configured to always use certificates
    for device authentication.
  resolution: This requirement is applicable to domain-joined systems, for standalone
    systems this is NA.  The default behavior for "Support device authentication using
    certificate" is "Automatic".  To correct this, configured the policy value for
    Computer Configuration >> Administrative Templates >> System >> Kerberos >> "Support
    device authentication using certificate" to "Not Configured or "Enabled" with
    either option selected in "Device authentication behavior using certificate:".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters\DevicePKInitEnabled'
    AND data = '1 (or if the Value Name does not exist)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The network selection user interface (UI) must not be displayed on
    the logon screen.
  platforms: windows
  platform: windows
  description: Enabling interaction with the network selection UI allows users to
    change connections to available networks without signing into Windows.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Logon >> "Do not display network selection UI" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System\DontDisplayNetworkSelectionUI'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DontDisplayNetworkSelectionUI.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Local users on domain-joined computers must not be enumerated.
  platforms: windows
  platform: windows
  description: The username is one part of logon credentials that could be used to
    gain access to a system. Preventing the enumeration of users limits this information
    to authorized personnel.
  resolution: This requirement is applicable to domain-joined systems, for standalone
    systems this is NA.  Configure the policy value for Computer Configuration >>
    Administrative Templates >> System >> Logon >> "Enumerate local users on domain-joined
    computers" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System\EnumerateLocalUsers'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: EnumerateLocalUsersOnDomainJoinedComputers.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Application Compatibility Program Inventory must be prevented from
    collecting data and sending the information to Microsoft.
  platforms: windows
  platform: windows
  description: Some features may communicate with the vendor, sending system information
    or downloading data or components for the feature. Turning off this capability
    will prevent potentially sensitive information from being sent outside the enterprise
    and uncontrolled updates to the system. This setting will prevent the Program
    Inventory from collecting data about a system and sending the information to Microsoft.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Application Compatibility >> "Turn off Inventory
    Collector" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AppCompat\DisableInventory'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG
  fix: AppCompatTurnOffProgramInventor.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Autoplay must be turned off for non-volume devices.
  platforms: windows
  platform: windows
  description: Allowing autoplay to execute may introduce malicious code to a system.
    Autoplay begins reading from a drive as soon as media is inserted in the drive.
    As a result, the setup file of programs or music on audio media may start. This
    setting will disable autoplay for non-volume devices (such as Media Transfer Protocol
    (MTP) devices).
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> AutoPlay Policies >> "Disallow Autoplay for
    non-volume devices" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer\NoAutoplayfornonVolume'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: DisallowAutoplayForNonVolumeDevices.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The default autorun behavior must be configured to prevent autorun
    commands.
  platforms: windows
  platform: windows
  description: Allowing autorun commands to execute may introduce malicious code to
    a system. Configuring this setting prevents autorun commands from executing.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> AutoPlay Policies >> "Set the default behavior
    for AutoRun" to "Enabled:Do not execute any autorun commands".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoAutorun'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Autoplay must be disabled for all drives.
  platforms: windows
  platform: windows
  description: Allowing autoplay to execute may introduce malicious code to a system.
    Autoplay begins reading from a drive as soon as media is inserted in the drive.
    As a result, the setup file of programs or music on audio media may start. By
    default, autoplay is disabled on removable drives, such as the floppy disk drive
    (but not the CD-ROM drive) and on network drives. If this policy is enabled, autoplay
    can be disabled on all drives.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> AutoPlay Policies >> "Turn off AutoPlay" to
    "Enabled:All Drives".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer\NoDriveTypeAutoRun'
    AND data = '255');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Enhanced anti-spoofing for facial recognition must be enabled on Windows
    11.
  platforms: windows
  platform: windows
  description: Enhanced anti-spoofing provides additional protections when using facial
    recognition with devices that support it.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Biometrics >> Facial Features >> "Configure
    enhanced anti-spoofing" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures\EnhancedAntiSpoofing'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Microsoft consumer experiences must be turned off.
  platforms: windows
  platform: windows
  description: Microsoft consumer experiences provides suggestions and notifications
    to users, which may include the installation of Windows Store apps. Organizations
    may control the execution of applications through other means such as allowlisting.
    Turning off Microsoft consumer experiences will help prevent the unwanted installation
    of suggested applications.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Cloud Content >> "Turn off Microsoft consumer
    experiences" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent\DisableWindowsConsumerFeatures'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Administrator accounts must not be enumerated during elevation.
  platforms: windows
  platform: windows
  description: Enumeration of administrator accounts when elevating can provide part
    of the logon information to an unauthorized user. This setting configures the
    system to always require users to type in a username and password to elevate a
    running application.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Credential User Interface >> "Enumerate administrator
    accounts on elevation" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: EnumerateAdministrators.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Enhanced diagnostic data must be limited to the minimum required to
    support Windows Analytics.
  platforms: windows
  platform: windows
  description: Some features may communicate with the vendor, sending system information
    or downloading data or components for the feature. Limiting this capability will
    prevent potentially sensitive information from being sent outside the enterprise.
    The "Enhanced" level for telemetry includes additional information beyond "Security"
    and "Basic" on how Windows and apps are used and advanced reliability data. Windows
    Analytics can use a "limited enhanced" level to provide information such as health
    data for...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Data Collection and Preview Builds >> "Limit
    optional diagnostic data for Windows Analytics" to "Enabled" with "Enable Desktop
    Analytics collection" selected in "Options:".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection\LimitEnhancedDiagnosticDataWindowsAnalytics'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: LimitEnhancedDiagnosticDataWindowsAnalytics.xml, AllowTelemetry.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows Telemetry must not be configured to Full.
  platforms: windows
  platform: windows
  description: Some features may communicate with the vendor, sending system information
    or downloading data or components for the feature. Limiting this capability will
    prevent potentially sensitive information from being sent outside the enterprise.
    The "Security" option for Telemetry configures the lowest amount of data, effectively
    none outside of the Malicious Software Removal Tool (MSRT), Defender and telemetry
    client settings. "Basic" sends basic diagnostic and usage data and may be required
    to suppo...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Data Collection and Preview Builds >> "Allow
    Diagnostic Data" to "Enabled" with "Send required diagnostic data" selected in
    "Options:".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DataCollection\AllowTelemetry'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: AllowTelemetry.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows Update must not obtain updates from other PCs on the internet.
  platforms: windows
  platform: windows
  description: Windows 11 allows Windows Update to obtain updates from additional
    sources instead of Microsoft. In addition to Microsoft, updates can be obtained
    from and sent to PCs on the local network as well as on the Internet. This is
    part of the Windows Update trusted process, however to minimize outside exposure,
    obtaining updates from or sending to systems on the internet must be prevented.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Delivery Optimization >> "Download Mode" to
    "Enabled" with any option except "Internet" selected.  Acceptable selections include:
    Bypass (100) Group (2) HTTP only (0) LAN (1) Simple (99)  .'
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization\DODownloadMode'
    AND (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config\DODownloadMode'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Microsoft Defender SmartScreen for Explorer must be enabled.
  platforms: windows
  platform: windows
  description: Microsoft Defender SmartScreen helps protect systems from programs
    downloaded from the internet that may be malicious. Enabling Microsoft Defender
    SmartScreen will warn or prevent users from running potentially malicious programs.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> File Explorer >> "Configure Windows Defender
    SmartScreen" to "Enabled" with "Warn and prevent bypass" selected.   Windows 11
    includes duplicate policies for this setting. It can also be configured under
    Computer Configuration >> Administrative Templates >> Windows Components >> Windows
    Defender SmartScreen >> Explorer.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System\EnableSmartScreen'
    AND data = '1') AND (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System\ShellSmartScreenLevel'
    AND data = 'Block');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: TO REVIEW

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Explorer Data Execution Prevention must be enabled.
  platforms: windows
  platform: windows
  description: Data Execution Prevention (DEP) provides additional protection by performing
    checks on memory to help prevent malicious code from running. This setting will
    prevent Data Execution Prevention from being turned off for File Explorer.
  resolution: The default behavior is for data execution prevention to be turned on
    for file explorer.  To correct this, configure the policy value for Computer Configuration
    >> Administrative Templates >> Windows Components >> File Explorer >> "Turn off
    Data Execution Prevention for Explorer" to "Not Configured" or "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer\NoDataExecutionPrevention'
    AND data = '0 (or if the Value Name does not exist)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - File Explorer heap termination on corruption must be disabled.
  platforms: windows
  platform: windows
  description: Legacy plug-in applications may continue to function when a File Explorer
    session has become corrupt. Disabling this feature will prevent this.
  resolution: The default behavior is for File Explorer heap termination on corruption
    to be enabled.  To correct this, configure the policy value for Computer Configuration
    >> Administrative Templates >> Windows Components >> File Explorer >> "Turn off
    heap termination on corruption" to "Not Configured" or "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer\NoHeapTerminationOnCorruption'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG
  fix: TurnOffHeapTerminationOnCorruption.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - File Explorer shell protocol must run in protected mode.
  platforms: windows
  platform: windows
  description: The shell protocol will limit the set of folders applications can open
    when run in protected mode. Restricting files an application can open, to a limited
    set of folders, increases the security of Windows.
  resolution: The default behavior is for shell protected mode to be turned on for
    file explorer.  To correct this, configure the policy value for Computer Configuration
    >> Administrative Templates >> Windows Components >> File Explorer >> "Turn off
    shell protocol protected mode" to "Not Configured" or "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\PreXPSP2ShellProtocolBehavior'
    AND data = '0 (or if the Value Name does not exist)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to disable Windows Game Recording and
    Broadcasting.
  platforms: windows
  platform: windows
  description: Windows Game Recording and Broadcasting is intended for use with games;
    however, it could potentially record screen shots of other applications and expose
    sensitive data. Disabling the feature will prevent this from occurring.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Game Recording and Broadcasting >>
    "Enables or disables Windows Game Recording and Broadcasting" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\GameDVR\AllowGameDVR'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: AllowGameDVR.xml
---
apiVersion: v1
kind: policy
spec:
  name: STIG - The use of a hardware security device with Windows Hello for Business
    must be enabled.
  platforms: windows
  platform: windows
  description: The use of a Trusted Platform Module (TPM) to store keys for Windows
    Hello for Business provides additional security. Keys stored in the TPM may only
    be used on that system while keys stored using software are more susceptible to
    compromise and could be used on other systems.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Hello for Business >> "Use a hardware
    security device" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PassportForWork\RequireSecurityDevice'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must be configured to require a minimum pin length of six
    characters or greater.
  platforms: windows
  platform: windows
  description: Windows allows the use of PINs as well as biometrics for authentication
    without sending a password to a network or website where it could be compromised.
    Longer minimum PIN lengths increase the available combinations an attacker would
    have to attempt. Shorter minimum length significantly reduces the strength.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> PIN Complexity >> "Minimum PIN length" to "6" or greater.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PassportForWork\PINComplexity\MinimumPINLength'
    AND CAST(data AS INTEGER) >= 6 (or greater));
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Passwords must not be saved in the Remote Desktop Client.
  platforms: windows
  platform: windows
  description: Saving passwords in the Remote Desktop Client could allow an unauthorized
    user to establish a remote desktop session to another system. The system must
    be configured to prevent users from saving passwords in the Remote Desktop Client.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Remote Desktop Services >> Remote Desktop Connection
    Client >> "Do not allow passwords to be saved" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
    NT\Terminal Services\DisablePasswordSaving' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DoNotAllowPasswordSaving.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Local drives must be prevented from sharing with Remote Desktop Session
    Hosts.
  platforms: windows
  platform: windows
  description: Preventing users from sharing the local drives on their client computers
    to Remote Session Hosts that they access helps reduce possible exposure of sensitive
    data.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Remote Desktop Services >> Remote Desktop Session
    Host >> Device and Resource Redirection >> "Do not allow drive redirection" to
    "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
    NT\Terminal Services\fDisableCdm' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DoNotAllowDriveRedirection.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Remote Desktop Session Host must require secure RPC communications.
  platforms: windows
  platform: windows
  description: Allowing unsecure RPC communication exposes the system to man in the
    middle attacks and data disclosure attacks. A man in the middle attack occurs
    when an intruder captures packets between a client and server and modifies them
    before allowing the packets to be exchanged. Usually the attacker will modify
    the information in the packets in an attempt to cause either the client or server
    to reveal sensitive information.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Remote Desktop Services >> Remote Desktop Session
    Host >> Security "Require secure RPC communication" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
    NT\Terminal Services\fEncryptRPCTraffic' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: RequireSecureRPCCommunication.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Remote Desktop Services must be configured with the client connection
    encryption set to the required level.
  platforms: windows
  platform: windows
  description: Remote connections must be encrypted to prevent interception of data
    or sensitive information. Selecting "High Level" will ensure encryption of Remote
    Desktop Services sessions in both directions.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Remote Desktop Services >> Remote Desktop Session
    Host >> Security >> "Set client connection encryption level" to "Enabled" and
    "High Level".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows
    NT\Terminal Services\MinEncryptionLevel' AND data = '3');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: ClientConnectionEncryptionLevel.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Attachments must be prevented from being downloaded from RSS feeds.
  platforms: windows
  platform: windows
  description: Attachments from RSS feeds may not be secure. This setting will prevent
    attachments from being downloaded from RSS feeds.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> RSS Feeds >> "Prevent downloading of enclosures"
    to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet
    Explorer\Feeds\DisableEnclosureDownload' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisableEnclosureDownloading.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Basic authentication for RSS feeds over HTTP must not be used.
  platforms: windows
  platform: windows
  description: Basic authentication uses plain text passwords that could be used to
    compromise a system.
  resolution: The default behavior is for the Windows RSS platform to not use Basic
    authentication over HTTP connections.  To correct this, configure the policy value
    for Computer Configuration >> Administrative Templates >> Windows Components >>
    RSS Feeds >> "Turn on Basic feed authentication over HTTP" to "Not Configured"
    or "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet
    Explorer\Feeds\AllowBasicAuthInClear' AND data = '0 (or if the Value Name does
    not exist)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Indexing of encrypted files must be turned off.
  platforms: windows
  platform: windows
  description: Indexing of encrypted files may expose sensitive data. This setting
    prevents encrypted files from being indexed.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Search >> "Allow indexing of encrypted files"
    to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows
    Search\AllowIndexingEncryptedStoresOrItems' AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: AllowIndexingEncryptedStoresOrItems.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Users must be prevented from changing installation options.
  platforms: windows
  platform: windows
  description: Installation options for applications are typically controlled by administrators.
    This setting prevents users from changing installation options that may bypass
    security features.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Installer >> "Allow user control over
    installs" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer\EnableUserControl'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows Installer feature "Always install with elevated privileges"
    must be disabled.
  platforms: windows
  platform: windows
  description: Standard user accounts must not be granted elevated privileges. Enabling
    Windows Installer to elevate privileges when installing applications can allow
    malicious persons and applications to gain full control of a system.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Installer >> "Always install with elevated
    privileges" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to prevent anonymous users from having
    the same rights as the Everyone group.
  platforms: windows
  platform: windows
  description: Access by anonymous users must be restricted. If this setting is enabled,
    then anonymous users have the same rights and permissions as the built-in Everyone
    group. Anonymous users must not have these permissions or rights.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network access:
    Let Everyone permissions apply to anonymous users" to "Disabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\everyoneincludesanonymous'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: everyoneincludesanonymous.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Users must be notified if a web-based program attempts to install software.
  platforms: windows
  platform: windows
  description: Web-based programs may attempt to install malicious software on a system.
    Ensuring users are notified if a web-based program attempts to install software
    allows them to refuse the installation.
  resolution: The default behavior is for Internet Explorer to warn users and select
    whether to allow or refuse installation when a web-based program attempts to install
    software on the system.  To correct this, configure the policy value for Computer
    Configuration >> Administrative Templates >> Windows Components >> Windows Installer
    >> "Prevent Internet Explorer security prompt for Windows Installer scripts" to
    "Not Configured" or "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer\SafeForScripting'
    AND data = '0 (or if the Value Name does not exist)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: SafeForScripting.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Automatically signing in the last interactive user after a system-initiated
    restart must be disabled.
  platforms: windows
  platform: windows
  description: Windows can be configured to automatically sign the user back in after
    a Windows Update restart. Some protections are in place to help ensure this is
    done in a secure fashion; however, disabling this will prevent the caching of
    credentials for this purpose and also ensure the user is aware of the restart.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Logon Options >> "Sign-in last interactive
    user automatically after a system-initiated restart" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\DisableAutomaticRestartSignOn'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: AllowAutomaticRestartSignOn.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - PowerShell script block logging must be enabled on Windows 11.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Enabling PowerShell script block
    logging will record det...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows PowerShell >> "Turn on PowerShell Script
    Block Logging" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging\EnableScriptBlockLogging'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: TurnOnPowerShellScriptBlockLogging.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - PowerShell Transcription must be enabled on Windows 11.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior.  Enabling PowerShell Transcription
    will record detailed i...
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows PowerShell >> "Turn on PowerShell Transcription"
    to "Enabled".  Specify the Transcript output directory to point to a Central Log
    Server or another secure location to prevent user access.
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription\EnableTranscripting'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows Remote Management (WinRM) client must not use Basic authentication.
  platforms: windows
  platform: windows
  description: Basic authentication uses plain text passwords that could be used to
    compromise a system.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Remote Management (WinRM) >> WinRM
    Client >> "Allow Basic authentication" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client\AllowBasic'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: AllowBasicAuthentication_Client.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows Remote Management (WinRM) client must not allow unencrypted
    traffic.
  platforms: windows
  platform: windows
  description: Unencrypted remote access to a system can allow sensitive information
    to be compromised. Windows remote management connections must be encrypted to
    prevent this.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Remote Management (WinRM) >> WinRM
    Client >> "Allow unencrypted traffic" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client\AllowUnencryptedTraffic'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: AllowUnencryptedTraffic_Client.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows Remote Management (WinRM) service must not use Basic authentication.
  platforms: windows
  platform: windows
  description: Basic authentication uses plain text passwords that could be used to
    compromise a system.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Remote Management (WinRM) >> WinRM
    Service >> "Allow Basic authentication" to "Disabled".  Severity Override Guidance:
    The AO can allow the severity override if they have reviewed the overall protection.
    This would only be allowed temporarily for implementation as documented and approved.  ....
    Allowing Basic authentication to be used for the sole creation of Office 365 DoD
    tenan...'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\AllowBasic'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: AllowBasicAuthentication_Service.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows Remote Management (WinRM) service must not allow unencrypted
    traffic.
  platforms: windows
  platform: windows
  description: Unencrypted remote access to a system can allow sensitive information
    to be compromised. Windows remote management connections must be encrypted to
    prevent this.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Remote Management (WinRM) >> WinRM
    Service >> "Allow unencrypted traffic" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\AllowUnencryptedTraffic'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: AllowUnencryptedTraffic_Service.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows Remote Management (WinRM) service must not store RunAs
    credentials.
  platforms: windows
  platform: windows
  description: Storage of administrative credentials could allow unauthorized access.
    Disallowing the storage of RunAs credentials for Windows Remote Management will
    prevent them from being used with plug-ins.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Remote Management (WinRM) >> WinRM
    Service >> "Disallow WinRM from storing RunAs credentials" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\DisableRunAs'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisallowStoringOfRunAsCredentials.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows Remote Management (WinRM) client must not use Digest authentication.
  platforms: windows
  platform: windows
  description: Digest authentication is not as strong as other options and may be
    subject to man-in-the-middle attacks.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> Windows Remote Management (WinRM) >> WinRM
    Client >> "Disallow Digest authentication" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client\AllowDigest'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DisallowDigestAuthentication.xml

---
apiVersion: v1 - Come back to, CSP error
kind: policy
spec:
  name: STIG - Windows 11 must be configured to prevent Windows apps from being activated
    by voice while the system is locked.
  platforms: windows
  platform: windows
  description: Allowing Windows apps to be activated by voice from the lock screen
    could allow for unauthorized use. Requiring logon will ensure the apps are only
    used by authorized personnel.
  resolution: 'Configure the policy value for Computer Configuration >> Administrative
    Templates >> Windows Components >> App Privacy >> "Let Windows apps activate with
    voice while the system is locked" to "Enabled" with Default for all Apps: set
    to Force Deny.   The requirement is NA if the policy value for Computer Configuration
    >> Administrative Templates >> Windows Components >> App Privacy >> "Let Windows
    apps activate with voice" is configured to "Enabled" with Default for all Apps:
    set to Force Deny.'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy\LetAppsActivateWithVoiceAboveLock'
    AND data = '2') AND (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy\LetAppsActivateWithVoice'
    AND data = '2');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The convenience PIN for Windows 11 must be disabled.
  platforms: windows
  platform: windows
  description: This policy controls whether a domain user can sign in using a convenience
    PIN to prevent enabling (Password Stuffer).
  resolution: Disable the convenience PIN sign-in.   To correct this, configure the
    policy value for Computer Configuration >> Administrative Templates >> System Logon >> Set "Turn on convenience PIN sign-in" to "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System\AllowDomainPINLogon'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: AllowPINLogon.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows Ink Workspace must be configured to disallow access above the
    lock.
  platforms: windows
  platform: windows
  description: This action secures Windows Ink, which contains applications and features
    oriented toward pen computing.
  resolution: Disable the convenience PIN sign-in.   To correct this, configure the
    policy value for Computer Configuration >> Administrative Templates >> Windows
    Components >> Windows Ink Workspace >> Set "Allow Windows Ink Workspace" to "Enabled
    and set Options "On, but disallow access above lock".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsInkWorkspace\AllowWindowsInkWorkspace'
    AND data = '');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 Kernel (Direct Memory Access) DMA Protection must be enabled.
  platforms: windows
  platform: windows
  description: Kernel DMA Protection to protect PCs against drive-by Direct Memory
    Access (DMA) attacks using PCI hot plug devices connected to Thunderbolt 3 ports.
    Drive-by DMA attacks can lead to disclosure of sensitive information residing
    on a PC, or even injection of malware that allows attackers to bypass the lock
    screen or control PCs remotely.
  resolution: Configure the policy value for Computer Configuration >> Administrative
    Templates >> System >> Kernel DMA Protection >> "Enumeration policy for external
    devices incompatible with Kernel DMA Protection" to "Enabled" with "Enumeration
    Policy" set to "Block All".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Kernel
    DMA Protection\DeviceEnumerationPolicy' AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DeviceEnumerationPolicy.xml
  
---
apiVersion: v1
kind: policy
spec:
  name: STIG - The DoD Root CA certificates must be installed in the Trusted Root
    Store.
  platforms: windows
  platform: windows
  description: To ensure secure DoD websites and DoD-signed code are properly validated,
    the system must trust the DoD Root Certificate Authorities (CAs). The DoD root
    certificates will ensure that the trust chain is established for server certificates
    issued from the DoD CAs.
  resolution: Install the DoD Root CA certificates. DoD Root CA 3 DoD Root CA 4 DoD
    Root CA 5                                                DoD Root CA 6  The InstallRoot
    tool is available on Cyber Exchange at https://cyber.mil/pki-pke/tools-configuration-files.
    PKI can be found at https://crl.gds.disa.mil/.
  query: '-- Manual check required: WN11-PK-000005

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The External Root CA certificates must be installed in the Trusted
    Root Store on unclassified systems.
  platforms: windows
  platform: windows
  description: To ensure secure websites protected with External Certificate Authority
    (ECA) server certificates are properly validated, the system must trust the ECA
    Root CAs. The ECA root certificates will ensure the trust chain is established
    for server certificates issued from the External CAs. This requirement only applies
    to unclassified systems.
  resolution: Install the ECA Root CA certificates on unclassified systems.  ECA Root
    CA 4  The InstallRoot tool is available on Cyber Exchange at https://cyber.mil/pki-pke/tools-configuration-files.
    PKI can be found at https://crl.gds.disa.mil/.
  query: '-- Manual check required: WN11-PK-000010

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The DoD Interoperability Root CA cross-certificates must be installed
    in the Untrusted Certificates Store on unclassified systems.
  platforms: windows
  platform: windows
  description: To ensure users do not experience denial of service when performing
    certificate-based authentication to DoD websites due to the system chaining to
    a root other than DoD Root CAs, the DoD Interoperability Root CA cross-certificates
    must be installed in the Untrusted Certificate Store. This requirement only applies
    to unclassified systems.
  resolution: Install the DoD Interoperability Root CA cross-certificates on unclassified
    systems.                                               Issued To - Issued By -
    Thumbprint DoD Root CA 3 - DoD Interoperability Root CA 2 - 49CBE933151872E17C8EAE7F0ABA97FB610F6477  The
    certificates can be installed using the InstallRoot tool. The tool and user guide
    are available on Cyber Exchange at https://cyber.mil/pki-pke/tools-configuration-files.
    Certificate bundles published by the PKI can be found at https://c...
  query: '-- Manual check required: WN11-PK-000015

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The US DOD CCEB Interoperability Root CA cross-certificates must be
    installed in the Untrusted Certificates Store on unclassified systems.
  platforms: windows
  platform: windows
  description: To ensure users do not experience denial of service when performing
    certificate-based authentication to DOD websites due to the system chaining to
    a root other than DOD Root CAs, the US DOD CCEB Interoperability Root CA cross-certificates
    must be installed in the Untrusted Certificate Store. This requirement only applies
    to unclassified systems.
  resolution: 'Install the US DOD CCEB Interoperability Root CA cross-certificate
    on unclassified systems.  Issued To - Issued By - Thumbprint 9B74964506C7ED9138070D08D5F8B969866560C8
    NotAfter: 7/18/2025 9:56:22 AM                                          Issued
    To: DOD Root CA 6 Issued By: US DOD CCEB Interoperability Root CA 2 Thumbprint:
    D471CA32F7A692CE6CBB6196BD3377FE4DBCD106 NotAfter: 7/18/2026   The certificates
    can be installed using the InstallRoot tool. The tool and user guide are available
    on Cyb...'
  query: '-- Manual check required: WN11-PK-000020

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Default permissions for the HKEY_LOCAL_MACHINE registry hive must be
    maintained.
  platforms: windows
  platform: windows
  description: The registry is integral to the function, security, and stability of
    the Windows system. Changing the system's registry permissions allows the possibility
    of unauthorized and anonymous modification to the operating system.
  resolution: Maintain the default permissions for the HKEY_LOCAL_MACHINE registry
    hive.  The default permissions of the higher level keys are noted below.  HKEY_LOCAL_MACHINE\SECURITY
    Type - "Allow" for all Inherited from - "None" for all Principal - Access - Applies
    to SYSTEM - Full Control - This key and subkeys Administrators - Special - This
    key and subkeys  HKEY_LOCAL_MACHINE\SOFTWARE Type - "Allow" for all Inherited
    from - "None" for all Principal - Access - Applies to Users - Read - This key
    and su...
  query: '-- Manual check required: WN11-RG-000005

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The built-in administrator account must be disabled.
  platforms: windows
  platform: windows
  description: The built-in administrator account is a well-known account subject
    to attack. It also provides no accountability to individual administrators on
    a system. It must be disabled to prevent its use.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Accounts: Administrator
    account status" to "Disabled".'
  query: '-- Manual check required: WN11-SO-000005

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The built-in guest account must be disabled.
  platforms: windows
  platform: windows
  description: A system faces an increased vulnerability threat if the built-in guest
    account is not disabled. This account is a known account that exists on all Windows
    systems and cannot be deleted. This account is initialized during the installation
    of the operating system with no password assigned.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Accounts: Guest
    account status" to "Disabled".'
  query: '-- Manual check required: WN11-SO-000010

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Local accounts with blank passwords must be restricted to prevent access
    from the network.
  platforms: windows
  platform: windows
  description: An account without a password can allow unauthorized access to a system
    as only the username would be required. Password policies must prevent accounts
    with blank passwords from existing on a system. However, if a local account with
    a blank password did exist, enabling this setting will prevent network access,
    limiting the account to local console logon only.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Accounts: Limit
    local account use of blank passwords to console logon only" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\LimitBlankPasswordUse'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: LimitBlankPasswordUse.ps1


---
apiVersion: v1
kind: policy
spec:
  name: STIG - The built-in administrator account must be renamed.
  platforms: windows
  platform: windows
  description: The built-in administrator account is a well-known account subject
    to attack. Renaming this account to an unidentified name improves the protection
    of this account and the system.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Accounts: Rename
    administrator account" to a name other than "Administrator".'
  query: '-- Manual check required: WN11-SO-000020

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  TODO: ./Device/Vendor/MSFT/Policy/Config/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The built-in guest account must be renamed.
  platforms: windows
  platform: windows
  description: The built-in guest account is a well-known user account on all Windows
    systems and, as initially installed, does not require a password. This can allow
    access to system resources by unauthorized users. Renaming this account to an
    unidentified name improves the protection of this account and the system.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Accounts: Rename
    guest account" to a name other than "Guest".'
  query: '-- Manual check required: WN11-SO-000025

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Audit policy using subcategories must be enabled.
  platforms: windows
  platform: windows
  description: Maintaining an audit trail of system activity logs can help identify
    configuration errors, troubleshoot service disruptions, and analyze compromises
    that have occurred, as well as detect attacks. Audit logs are necessary to provide
    a trail of evidence in case the system or network is compromised. Collecting this
    data is essential for analyzing the security of information assets and detecting
    signs of suspicious and unexpected behavior. This setting allows administrators
    to enable more precise...
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Audit: Force audit
    policy subcategory settings (Windows Vista or later) to override audit policy
    category settings" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\SCENoApplyLegacyAuditPolicy'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The computer account password must not be prevented from being reset.
  platforms: windows
  platform: windows
  description: Computer account passwords are changed automatically on a regular basis.
    Disabling automatic password changes can make the system more vulnerable to malicious
    access. Frequent password changes can be a significant safeguard for the system.
    A new password for the computer account will be generated every 30 days.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Domain member:
    Disable machine account password changes" to "Disabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The maximum age for machine account passwords must be configured to
    30 days or less.
  platforms: windows
  platform: windows
  description: Computer account passwords are changed automatically on a regular basis.
    This setting controls the maximum password age that a machine account may have.
    This setting must be set to no more than 30 days, ensuring the machine changes
    its password monthly.
  resolution: 'This is the default configuration for this setting (30 days).  Configure
    the policy value for Computer Configuration >> Windows Settings >> Security Settings
    >> Local Policies >> Security Options >> "Domain member: Maximum machine account
    password age" to "30" or less (excluding 0 which is unacceptable).'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\MaximumPasswordAge'
    AND CAST(data AS INTEGER) <= 30);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to require a strong session key.
  platforms: windows
  platform: windows
  description: A computer connecting to a domain controller will establish a secure
    channel. Requiring strong session keys enforces 128-bit encryption between systems.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Domain member:
    Require strong (Windows 2000 or Later) session key" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\RequireStrongKey'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The machine inactivity limit must be set to 15 minutes, locking the
    system with the screensaver.
  platforms: windows
  platform: windows
  description: 'Unattended systems are susceptible to unauthorized use and must be
    locked when unattended. The screen saver must be set at a maximum of 15 minutes
    and be password protected. This protects critical and sensitive data from exposure
    to unauthorized personnel with physical access to the computer.  Satisfies: SRG-OS-000279-GPOS-00109,
    SRG-OS-000163-GPOS-00072'
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Interactive logon:
    Machine inactivity limit" to "900" seconds" or less, excluding "0" which is effectively
    disabled.'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\InactivityTimeoutSecs'
    AND CAST(data AS INTEGER) <= 900);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: PasswordRequirements.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The required legal notice must be configured to display before console
    logon.
  platforms: windows
  platform: windows
  description: 'Failure to display the logon banner prior to a logon attempt will
    negate legal proceedings resulting from unauthorized access to system resources.  Satisfies:
    SRG-OS-000024-GPOS-00007, SRG-OS-000228-GPOS-00088, SRG-OS-000024-GPOS-00007'
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Interactive logon:
    Message text for users attempting to log on" to the following.  You are accessing
    a U.S. Government (USG) Information System (IS) that is provided for USG-authorized
    use only.  By using this IS (which includes any device attached to this IS), you
    consent to the following conditions:  -The USG routinely intercepts and monitors
    communication...'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeText'
    AND data != '' AND LENGTH(data) > 0);
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows message title for the legal notice must be configured.
  platforms: windows
  platform: windows
  description: Failure to display the logon banner prior to a logon attempt will negate
    legal proceedings resulting from unauthorized access to system resources.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Interactive logon:
    Message title for users attempting to log on" to "DoD Notice and Consent Banner",
    "US Department of Defense Warning Statement", or a site-defined equivalent.  If
    a site-defined title is used, it can in no case contravene or modify the language
    of the banner text required in WN11-SO-000075.'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LegalNoticeCaption'
    AND data = 'See message title above');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Caching of logon credentials must be limited.
  platforms: windows
  platform: windows
  description: The default Windows configuration caches the last logon credentials
    for users who log on interactively to a system. This feature is provided for system
    availability reasons, such as the user's machine being disconnected from the network
    or domain controllers being unavailable. Even though the credential cache is well-protected,
    if a system is attacked, an unauthorized individual may isolate the password to
    a domain user account using a password-cracking program and gain access to the
    domain.
  resolution: 'This is the default configuration for this setting (10 logons to cache).  Configure
    the policy value for Computer Configuration >> Windows Settings >> Security Settings
    >> Local Policies >> Security Options >> "Interactive logon: Number of previous
    logons to cache (in case domain controller is not available)" to "10" logons or
    less.  This setting only applies to domain-joined systems, however, it is configured
    by default on all systems.'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Winlogon\CachedLogonsCount' AND CAST(data AS INTEGER) <= 10
    (or less));
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Smart Card removal option must be configured to Force Logoff or
    Lock Workstation.
  platforms: windows
  platform: windows
  description: Unattended systems are susceptible to unauthorized use and must be
    locked. Configuring a system to lock when a smart card is removed will ensure
    the system is inaccessible when unattended.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Interactive logon:
    Smart card removal behavior" to "Lock Workstation" or "Force Logoff".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SCRemoveOption' AND data = '1 (Lock Workstation) or
    2 (Force Logoff)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows SMB client must be configured to always perform SMB packet
    signing.
  platforms: windows
  platform: windows
  description: The server message block (SMB) protocol provides the basis for many
    network operations. Digitally signed SMB packets aid in preventing man-in-the-middle
    attacks. If this policy is enabled, the SMB client will only communicate with
    an SMB server that performs SMB packet signing.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Microsoft network
    client: Digitally sign communications (always)" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters\RequireSecuritySignature'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Unencrypted passwords must not be sent to third-party SMB Servers.
  platforms: windows
  platform: windows
  description: Some non-Microsoft SMB servers only support unencrypted (plain text)
    password authentication. Sending plain text passwords across the network, when
    authenticating to an SMB server, reduces the overall security of the environment.
    Check with the vendor of the SMB server to see if there is a way to support encrypted
    password authentication.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Microsoft network
    client: Send unencrypted password to third-party SMB servers" to "Disabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters\EnablePlainTextPassword'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The Windows SMB server must be configured to always perform SMB packet
    signing.
  platforms: windows
  platform: windows
  description: The server message block (SMB) protocol provides the basis for many
    network operations. Digitally signed SMB packets aid in preventing man-in-the-middle
    attacks. If this policy is enabled, the SMB server will only communicate with
    an SMB client that performs SMB packet signing.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Microsoft network
    server: Digitally sign communications (always)" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters\RequireSecuritySignature'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Anonymous SID/Name translation must not be allowed.
  platforms: windows
  platform: windows
  description: Allowing anonymous SID/Name translation can provide sensitive information
    for accessing a system. Only authorized users must be able to perform such translations.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network access:
    Allow anonymous SID/Name translation" to "Disabled".'
  query: '-- Manual check required: WN11-SO-000140

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Anonymous access to Named Pipes and Shares must be restricted.
  platforms: windows
  platform: windows
  description: 'Allowing anonymous access to named pipes or shares provides the potential
    for unauthorized system access. This setting restricts access to those defined
    in "Network access: Named Pipes that can be accessed anonymously" and "Network
    access: Shares that can be accessed anonymously", both of which must be blank
    under other requirements.'
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network access:
    Restrict anonymous access to Named Pipes and Shares" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters\RestrictNullSessAccess'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Remote calls to the Security Account Manager (SAM) must be restricted
    to Administrators.
  platforms: windows
  platform: windows
  description: The Windows SAM stores users' passwords. Restricting remote rpc connections
    to the SAM to Administrators helps protect those credentials.
  resolution: 'Navigate to the policy Computer Configuration >> Windows Settings >>
    Security Settings >> Local Policies >> Security Options >> "Network access: Restrict
    clients allowed to make remote calls to SAM".  Select "Edit Security" to configure
    the "Security descriptor:".  Add "Administrators" in "Group or user names:" if
    it is not already listed (this is the default).  Select "Administrators" in "Group
    or user names:".  Select "Allow" for "Remote Access" in "Permissions for "Administrators".  Click
    ...'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\RestrictRemoteSAM'
    AND data = 'O:BAG:BAD:(A;;RC;;;BA)');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - NTLM must be prevented from falling back to a Null session.
  platforms: windows
  platform: windows
  description: NTLM sessions that are allowed to fall back to Null (unauthenticated)
    sessions may gain unauthorized access.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    Allow LocalSystem NULL session fallback" to "Disabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA\MSV1_0\allownullsessionfallback'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - PKU2U authentication using online identities must be prevented.
  platforms: windows
  platform: windows
  description: PKU2U is a peer-to-peer authentication protocol.  This setting prevents
    online identities from authenticating to domain-joined systems. Authentication
    will be centrally managed with Windows user accounts.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    Allow PKU2U authentication requests to this computer to use online identities"
    to "Disabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA\pku2u\AllowOnlineID'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Kerberos encryption types must be configured to prevent the use of
    DES and RC4 encryption suites.
  platforms: windows
  platform: windows
  description: Certain encryption types are no longer considered secure. This setting
    configures a minimum encryption type for Kerberos, preventing the use of the DES
    and RC4 encryption suites.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    Configure encryption types allowed for Kerberos" to "Enabled" with only the following
    selected:  AES128_HMAC_SHA1 AES256_HMAC_SHA1 Future encryption types'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters\SupportedEncryptionTypes'
    AND data = '2147483640');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to prevent the storage of the LAN Manager
    hash of passwords.
  platforms: windows
  platform: windows
  description: The LAN Manager hash uses a weak encryption algorithm and there are
    several tools available that use this hash to retrieve account passwords. This
    setting controls whether or not a LAN Manager hash of the password is stored in
    the SAM the next time the password is changed.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    Do not store LAN Manager hash value on next password change" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\NoLmHash'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG
  fix: NoLMHash.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The LanMan authentication level must be set to send NTLMv2 response
    only, and to refuse LM and NTLM.
  platforms: windows
  platform: windows
  description: The Kerberos v5 authentication protocol is the default for authentication
    of users who are logging on to domain accounts. NTLM, which is less secure, is
    retained in later Windows versions for compatibility with clients and servers
    that are running earlier versions of Windows or applications that still use it.
    It is also used to authenticate logons to stand-alone computers that are running
    later versions.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    LAN Manager authentication level" to "Send NTLMv2 response only. Refuse LM & NTLM".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\LmCompatibilityLevel'
    AND data = '5');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to meet the minimum session security
    requirement for NTLM SSP based clients.
  platforms: windows
  platform: windows
  description: Microsoft has implemented a variety of security support providers for
    use with RPC sessions. All of the options must be enabled to ensure the maximum
    security level.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    Minimum session security for NTLM SSP based (including secure RPC) clients" to
    "Require NTLMv2 session security" and "Require 128-bit encryption" (all options
    selected).'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\NTLMMinClientSec'
    AND data = '537395200');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to meet the minimum session security
    requirement for NTLM SSP based servers.
  platforms: windows
  platform: windows
  description: Microsoft has implemented a variety of security support providers for
    use with RPC sessions. All of the options must be enabled to ensure the maximum
    security level.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "Network security:
    Minimum session security for NTLM SSP based (including secure RPC) servers" to
    "Require NTLMv2 session security" and "Require 128-bit encryption" (all options
    selected).'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0\NTLMMinServerSec'
    AND data = '537395200');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The system must be configured to use FIPS-compliant algorithms for
    encryption, hashing, and signing.
  platforms: windows
  platform: windows
  description: This setting ensures that the system uses algorithms that are FIPS-compliant
    for encryption, hashing, and signing. FIPS-compliant algorithms meet specific
    standards established by the U.S. Government and must be the algorithms used for
    all OS encryption functions.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "System cryptography:
    Use FIPS compliant algorithms for encryption, hashing, and signing" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy\Enabled'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: FIPSAlgorithmPolicy.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The default permissions of global system objects must be increased.
  platforms: windows
  platform: windows
  description: Windows systems maintain a global list of shared system resources such
    as DOS device names, mutexes, and semaphores. Each type of object is created with
    a default DACL that specifies who can access the objects with what permissions.
    If this policy is enabled, the default DACL is stronger, allowing non-admin users
    to read shared objects, but not modify shared objects that they did not create.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "System objects:
    Strengthen default permissions of internal system objects (e.g. Symbolic links)"
    to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
    Manager\ProtectionMode' AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG
  fix: EnableProtectionMode.ps1

---
apiVersion: v1
kind: policy
spec:
  name: STIG - User Account Control approval mode for the built-in Administrator must
    be enabled.
  platforms: windows
  platform: windows
  description: User Account Control (UAC) is a security mechanism for limiting the
    elevation of privileges, including administrative accounts, unless authorized.
    This setting configures the built-in Administrator account so that it runs in
    Admin Approval Mode.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "User Account Control:
    Admin Approval Mode for the Built-in Administrator account" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\FilterAdministratorToken'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: UseAdminApprovalMode.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - User Account Control must prompt administrators for consent on the
    secure desktop.
  platforms: windows
  platform: windows
  description: User Account Control (UAC) is a security mechanism for limiting the
    elevation of privileges, including administrative accounts, unless authorized.
    This setting configures the elevation requirements for logged on administrators
    to complete a task that requires raised privileges.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "User Account Control:
    Behavior of the elevation prompt for administrators in Admin Approval Mode" to
    "Prompt for consent on the secure desktop".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin'
    AND data = '2');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: BehaviorOfTheElevationPromptForAdministrators.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 systems must use either Group Policy or an approved Mobile
    Device Management (MDM) product to enforce STIG compliance.
  platforms: windows
  platform: windows
  description: Without Windows 11 systems being managed, devices could be rogue and
    become targets of an attacker.
  resolution: Configure the Windows 11 system to use either Group Policy or an approved
    MDM product to enforce STIG compliance.
  query: '-- Manual check required: WN11-CC-000063

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must use multifactor authentication for local and network
    access to privileged and nonprivileged accounts.
  platforms: windows
  platform: windows
  description: 'Without the use of multifactor authentication, the ease of access
    to privileged and nonprivileged functions is greatly increased.   All domain accounts
    must be enabled for multifactor authentication with the exception of local emergency
    accounts.   Multifactor authentication requires using two or more factors to achieve
    authentication.  Factors include:   1) Something a user knows (e.g., password/PIN);  2)
    Something a user has (e.g., cryptographic identification device, token); and  3)
    Someth...'
  resolution: For nondomain joined systems, configuring Windows Hello for sign-on
    options would be suggested based on the organization's needs and capabilities.
  query: '-- Manual check required: WN11-SO-000251

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - User Account Control must automatically deny elevation requests for
    standard users.
  platforms: windows
  platform: windows
  description: User Account Control (UAC) is a security mechanism for limiting the
    elevation of privileges, including administrative accounts, unless authorized.
    Denying elevation requests from standard user accounts requires tasks that need
    elevation to be initiated by accounts with administrative privileges. This ensures
    correct accounts are used on the system for privileged tasks to help mitigate
    credential theft.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "User Account Control:
    Behavior of the elevation prompt for standard users" to "Automatically deny elevation
    requests".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorUser'
    AND data = '0');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: BehaviorOfTheElevationPromptForStandardUsers.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - User Account Control must be configured to detect application installations
    and prompt for elevation.
  platforms: windows
  platform: windows
  description: User Account Control (UAC) is a security mechanism for limiting the
    elevation of privileges, including administrative accounts, unless authorized.
    This setting requires Windows to respond to application installation requests
    by prompting for credentials.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "User Account Control:
    Detect application installations and prompt for elevation" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableInstallerDetection'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DetectApplicationInstallationsAndPromptForElevation.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - User Account Control must only elevate UIAccess applications that are
    installed in secure locations.
  platforms: windows
  platform: windows
  description: User Account Control (UAC) is a security mechanism for limiting the
    elevation of privileges, including administrative accounts, unless authorized.
    This setting configures Windows to only allow applications installed in a secure
    location on the file system, such as the Program Files or the Windows\System32
    folders, to run with elevated privileges.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "User Account Control:
    Only elevate UIAccess applications that are installed in secure locations" to
    "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableSecureUIAPaths'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: OnlyElevateUIAccessApplicationsThatAreInstalledInSecureLocations.xml
---
apiVersion: v1
kind: policy
spec:
  name: STIG - User Account Control must run all administrators in Admin Approval
    Mode, enabling UAC.
  platforms: windows
  platform: windows
  description: User Account Control (UAC) is a security mechanism for limiting the
    elevation of privileges, including administrative accounts, unless authorized.
    This setting enables UAC.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "User Account Control:
    Run all administrators in Admin Approval Mode" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: RunAllAdministratorsInAdminApprovalMode.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - User Account Control must virtualize file and registry write failures
    to per-user locations.
  platforms: windows
  platform: windows
  description: User Account Control (UAC) is a security mechanism for limiting the
    elevation of privileges, including administrative accounts, unless authorized.
    This setting configures non-UAC compliant applications to run in virtualized file
    and registry entries in per-user locations, allowing them to run.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> Security Options >> "User Account Control:
    Virtualize file and registry write failures to per-user locations" to "Enabled".'
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableVirtualization'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: VirtualizeFileAndRegistryWriteFailuresToPerUserLocations.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Passwords for enabled local Administrator accounts must be changed
    at least every 60 days.
  platforms: windows
  platform: windows
  description: The longer a password is in use, the greater the opportunity for someone
    to gain unauthorized knowledge of the password. A local Administrator account
    is not generally used and its password may not be changed as frequently as necessary.
    Changing the password for enabled Administrator accounts on a regular basis will
    limit its exposure.  Windows LAPS must be used to change the built-in Administrator
    account password.
  resolution: 'Change the enabled local Administrator account password at least every
    60 days.   Windows LAPS must be used to change the built-in Administrator account
    password. Domain-joined and nondomain-joined systems can configure this to occur
    more frequently. LAPS will change the password every 30 days by default.   More
    information is available at: https://techcommunity.microsoft.com/t5/windows-it-pro-blog/by-popular-demand-windows-laps-available-now/ba-p/3788747
    https://learn.microsoft.com/en-us/win...'
  query: '-- Manual check required: WN11-SO-000280

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Toast notifications to the lock screen must be turned off.
  platforms: windows
  platform: windows
  description: Toast notifications that are displayed on the lock screen could display
    sensitive information to unauthorized personnel. Turning off this feature will
    limit access to the information to a logged on user.
  resolution: Configure the policy value for User Configuration >> Administrative
    Templates >> Start Menu and Taskbar >> Notifications >> "Turn off toast notifications
    on the lock screen" to "Enabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\PushNotifications\NoToastApplicationNotificationOnLockScreen'
    AND data = '1');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_low
  contributors: DISA STIG
  fix: NoLockScreenToastNotification.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Zone information must be preserved when saving attachments.
  platforms: windows
  platform: windows
  description: Preserving zone of origin (internet, intranet, local, restricted) information
    on file attachments allows Windows to determine risk.
  resolution: The default behavior is for Windows to mark file attachments with their
    zone information.  To correct this, configure the policy value for User Configuration
    >> Administrative Templates >> Windows Components >> Attachment Manager >> "Do
    not preserve zone information in file attachments" to "Not Configured" or "Disabled".
  query: SELECT 1 FROM registry WHERE (path = 'HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Attachments\SaveZoneInformation'
    AND data = '2');
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG
  fix: DoNotPreserveZoneInformation.xml

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Access Credential Manager as a trusted caller" user right must
    not be assigned to any groups or accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Access Credential Manager
    as a trusted caller" user right may be able to retrieve the credentials of other
    accounts from Credential Manager.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Access Credential
    Manager as a trusted caller" to be defined but containing no entries (blank).
  query: '-- Manual check required: WN11-UR-000005

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Access this computer from the network" user right must only be
    assigned to the Administrators and Remote Desktop Users groups.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Access this computer from
    the network" user right may access resources on the system, and must be limited
    to those that require it.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Access this
    computer from the network" to only include the following groups or accounts:  Administrators   Remote
    Desktop Users'
  query: '-- Manual check required: WN11-UR-000010

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Act as part of the operating system" user right must not be assigned
    to any groups or accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Act as part of the operating
    system" user right can assume the identity of any user and gain access to resources
    that user is authorized to access. Any accounts with this right can take complete
    control of a system.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Act as part
    of the operating system" to be defined but containing no entries (blank).
  query: '-- Manual check required: WN11-UR-000015

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Allow log on locally" user right must only be assigned to the
    Administrators and Users groups.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Allow log on locally" user
    right can log on interactively to a system.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Allow log
    on locally" to only include the following groups or accounts:  Administrators
    Users'
  query: '-- Manual check required: WN11-UR-000025

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Back up files and directories" user right must only be assigned
    to the Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Back up files and directories"
    user right can circumvent file and directory permissions and could allow access
    to sensitive data."
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Back up files
    and directories" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000030

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Change the system time" user right must only be assigned to Administrators
    and Local Service.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Change the system time"
    user right can change the system time, which can impact authentication, as well
    as affect time stamps on event log entries.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Change the
    system time" to only include the following groups or accounts:  Administrators
    LOCAL SERVICE'
  query: '-- Manual check required: WN11-UR-000035

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Create a pagefile" user right must only be assigned to the Administrators
    group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Create a pagefile" user
    right can change the size of a pagefile, which could affect system performance.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Create a
    pagefile" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000040

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Create a token object" user right must not be assigned to any
    groups or accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Create a token object" user right allows
    a process to create an access token. This could be used to provide elevated rights
    and compromise a system.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Create a
    token object" to be defined but containing no entries (blank).
  query: '-- Manual check required: WN11-UR-000045

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Create global objects" user right must only be assigned to Administrators,
    Service, Local Service, and Network Service.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Create global objects"
    user right can create objects that are available to all sessions, which could
    affect processes in other users' sessions.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Create global
    objects" to only include the following groups or accounts:  Administrators LOCAL
    SERVICE NETWORK SERVICE SERVICE'
  query: '-- Manual check required: WN11-UR-000050

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Create permanent shared objects" user right must not be assigned
    to any groups or accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Create permanent shared
    objects" user right could expose sensitive data by creating shared objects.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Create permanent
    shared objects" to be defined but containing no entries (blank).
  query: '-- Manual check required: WN11-UR-000055

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Create symbolic links" user right must only be assigned to the
    Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Create symbolic links"
    user right can create pointers to other objects, which could potentially expose
    the system to attack.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Create symbolic
    links" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000060

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Debug programs" user right must only be assigned to the Administrators
    group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Debug Programs" user right
    can attach a debugger to any process or to the kernel, providing complete access
    to sensitive and critical operating system components. This right is given to
    Administrators in the default configuration.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Debug programs"
    to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000065

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_high
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Deny access to this computer from the network" user right on workstations
    must be configured to prevent access from highly privileged domain accounts and
    local accounts on domain systems and unauthenticated access on all systems.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Deny access to this computer from the
    network" right defines the accounts that are prevented from logging on from the
    network.  In an Active Directory Domain, denying logons to the Enterprise Admins
    and Domain Admins groups on lower trust systems helps mitigate the risk of privilege
    escalation from credential theft attacks, which could lead to the compromise of
    an entire domain. ...
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Deny access
    to this computer from the network" to include the following:  Domain Systems Only:
    Enterprise Admins group Domain Admins group Local account (see Note below)  All
    Systems: Guests group  Privileged Access Workstations (PAWs) dedicated to the
    management of Active Directory are exempt from denying the Enterprise Admins and
    Domain Admins groups...'
  query: '-- Manual check required: WN11-UR-000070

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Deny log on as a batch job" user right on domain-joined workstations
    must be configured to prevent access from highly privileged domain accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Deny log on as a batch job" right defines
    accounts that are prevented from logging on to the system as a batch job, such
    as Task Scheduler.  In an Active Directory Domain, denying logons to the Enterprise
    Admins and Domain Admins groups on lower trust systems helps mitigate the risk
    of privilege escalation from credential theft attacks which could lead to the
    compromise of an ent...
  resolution: 'This requirement is applicable to domain-joined systems, for standalone
    systems this is NA.  Configure the policy value for Computer Configuration >>
    Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment
    >> "Deny log on as a batch job" to include the following:  Domain Systems Only:
    Enterprise Admin Group Domain Admin Group'
  query: '-- Manual check required: WN11-UR-000075

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Deny log on as a service" user right on Windows 11 domain-joined
    workstations must be configured to prevent access from highly privileged domain
    accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Deny log on as a service" right defines
    accounts that are denied log on as a service.  In an Active Directory Domain,
    denying logons to the Enterprise Admins and Domain Admins groups on lower trust
    systems helps mitigate the risk of privilege escalation from credential theft
    attacks which could lead to the compromise of an entire domain.  Incorrect configurations
    could prevent se...
  resolution: 'This requirement is applicable to domain-joined systems, for standalone
    systems this is NA.  Configure the policy value for Computer Configuration >>
    Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment
    >> "Deny log on as a service" to include the following:  Domain Systems Only:
    Enterprise Admins Group Domain Admins Group'
  query: '-- Manual check required: WN11-UR-000080

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Deny log on locally" user right on workstations must be configured
    to prevent access from highly privileged domain accounts on domain systems and
    unauthenticated access on all systems.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Deny log on locally" right defines accounts
    that are prevented from logging on interactively.  In an Active Directory Domain,
    denying logons to the Enterprise Admins and Domain Admins groups on lower trust
    systems helps mitigate the risk of privilege escalation from credential theft
    attacks, which could lead to the compromise of an entire domain.  The Guests group
    must be assigne...
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Deny log
    on locally" to include the following:  Domain Systems Only: Enterprise Admins
    Group Domain Admins Group  Privileged Access Workstations (PAWs) dedicated to
    the management of Active Directory are exempt from denying the Enterprise Admins
    and Domain Admins groups. (See the Windows Privileged Access Workstation STIG
    for PAW requirements.)  All Sy...'
  query: '-- Manual check required: WN11-UR-000085

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Deny log on through Remote Desktop Services" user right on Windows
    11 workstations must be configured to prevent access from highly privileged domain
    accounts and local accounts on domain systems and unauthenticated access on all
    systems.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Deny log on through Remote Desktop Services"
    right defines the accounts that are prevented from logging on using Remote Desktop
    Services.  If Remote Desktop Services is not used by the organization, the Everyone
    group must be assigned this right to prevent all access.  In an Active Directory
    Domain, denying logons to the Enterprise Admins and Domain Admins groups on lower
    trust s...
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Deny log
    on through Remote Desktop Services" to include the following:  If Remote Desktop
    Services is not used by the organization, assign the Everyone group this right
    to prevent all access.  Domain Systems Only: Enterprise Admins group Domain Admins
    group Local account (see Note below)  All Systems: Guests group  Privileged Access
    Workstations (PAWs)...'
  query: '-- Manual check required: WN11-UR-000090

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Enable computer and user accounts to be trusted for delegation"
    user right must not be assigned to any groups or accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Enable computer and user accounts to
    be trusted for delegation" user right allows the "Trusted for Delegation" setting
    to be changed. This could potentially allow unauthorized users to impersonate
    other users.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Enable computer
    and user accounts to be trusted for delegation" to be defined but containing no
    entries (blank).
  query: '-- Manual check required: WN11-UR-000095

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Force shutdown from a remote system" user right must only be assigned
    to the Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Force shutdown from a remote
    system" user right can remotely shut down a system which could result in a DoS.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Force shutdown
    from a remote system" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000100

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Impersonate a client after authentication" user right must only
    be assigned to Administrators, Service, Local Service, and Network Service.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Impersonate a client after authentication"
    user right allows a program to impersonate another user or account to run on their
    behalf. An attacker could potentially use this to elevate privileges.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Impersonate
    a client after authentication" to only include the following groups or accounts:  Administrators
    LOCAL SERVICE NETWORK SERVICE SERVICE'
  query: '-- Manual check required: WN11-UR-000110

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Load and unload device drivers" user right must only be assigned
    to the Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Load and unload device drivers" user
    right allows device drivers to dynamically be loaded on a system by a user. This
    could potentially be used to install malicious code by an attacker.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Load and
    unload device drivers" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000120

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Lock pages in memory" user right must not be assigned to any groups
    or accounts.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  The "Lock pages in memory" user right allows
    physical memory to be assigned to processes, which could cause performance issues
    or a DoS.
  resolution: Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Lock pages
    in memory" to be defined but containing no entries (blank).
  query: '-- Manual check required: WN11-UR-000125

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Manage auditing and security log" user right must only be assigned
    to the Administrators group.
  platforms: windows
  platform: windows
  description: 'Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Manage auditing and security
    log" user right can manage the security log and change auditing configurations.
    This could be used to clear evidence of tampering.  Satisfies: SRG-OS-000057-GPOS-00027,
    SRG-OS-000063-GPOS-00032'
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Manage auditing
    and security log" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000130

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Modify firmware environment values" user right must only be assigned
    to the Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Modify firmware environment
    values" user right can change hardware configuration environment variables. This
    could result in hardware failures or a DoS.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Modify firmware
    environment values" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000140

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Perform volume maintenance tasks" user right must only be assigned
    to the Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Perform volume maintenance
    tasks" user right can manage volume and disk configurations. They could potentially
    delete volumes, resulting in data loss or a DoS.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Perform volume
    maintenance tasks" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000145

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Profile single process" user right must only be assigned to the
    Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Profile single process"
    user right can monitor non-system processes performance. An attacker could potentially
    use this to identify processes to attack.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Profile single
    process" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000150

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Restore files and directories" user right must only be assigned
    to the Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Restore files and directories"
    user right can circumvent file and directory permissions and could allow access
    to sensitive data. It could also be used to over-write more current data.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Restore files
    and directories" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000160

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - The "Take ownership of files or other objects" user right must only
    be assigned to the Administrators group.
  platforms: windows
  platform: windows
  description: Inappropriate granting of user rights can provide system, administrative,
    and other high-level capabilities.  Accounts with the "Take ownership of files
    or other objects" user right can take ownership of objects and make changes.
  resolution: 'Configure the policy value for Computer Configuration >> Windows Settings
    >> Security Settings >> Local Policies >> User Rights Assignment >> "Take ownership
    of files or other objects" to only include the following groups or accounts:  Administrators'
  query: '-- Manual check required: WN11-UR-000165

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Internet Explorer must be disabled for Windows 11.
  platforms: windows
  platform: windows
  description: Internet Explorer 11 (IE11) is not supported on Windows 11 semi-annual
    channel.
  resolution: 'For Windows 11 semi-annual channel, remove or disable the IE11 application.   To
    disable IE11 as a standalone browser:  Set the policy value for "Computer Configuration/Administrative
    Templates/Windows Components/Internet Explorer/Disable Internet Explorer 11 as
    a standalone browser" to "Enabled" with the option value set to "Never".'
  query: '-- Manual check required: WN11-CC-000391

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must not have portproxy enabled or in use.
  platforms: windows
  platform: windows
  description: Having portproxy enabled or configured in Windows 10 could allow a
    man-in-the-middle attack.
  resolution: Contact the Administrator to run "netsh interface portproxy delete"
    with elevation. Remove any enabled portproxies that may be configured.
  query: '-- Manual check required: WN11-00-000395

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Windows 11 must have command line process auditing events enabled for
    failures.
  platforms: windows
  platform: windows
  description: When this policy setting is enabled, the operating system generates
    audit events when a process fails to start and the name of the program or user
    that created it.  These audit events can assist in understanding how a computer
    is being used and tracking user activity.
  resolution: Go to Computer Configuration >> Windows Settings >>Security Settings>>
    Advanced Audit Policy Configuration >> System Audit Policies >> Detailed Tracking
    >> Set "Audit Process Creation" to "Failure".
  query: '-- Manual check required: WN11-AU-000585

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

---
apiVersion: v1
kind: policy
spec:
  name: STIG - Copilot in Windows must be disabled for Windows 11
  platforms: windows
  platform: windows
  description: Some features may communicate with the vendor, sending system information
    or downloading data or components for the feature. Turning off this capability
    will prevent potentially sensitive information from being sent outside the enterprise
    and uncontrolled updates to the system.
  resolution: Configure the policy value for User Configuration >> Administrative
    Templates >> Windows Components >> Windows Copilot >> "Turn off Windows Copilot"
    to "Enabled".
  query: '-- Manual check required: WN11-00-000125

    SELECT 0 WHERE 1=0;'
  purpose: Informational
  tags: compliance, STIG, STIG_Win11_v2, severity_medium
  contributors: DISA STIG

